import M from"./PsLabel2.js";import{N as T,u as H}from"./NotificationStore.js";import R from"./PsIcon2.js";import E from"./PsDropdown.js";import{P as z}from"./PsValueStore.js";import O from"./PsLoadingDialog3.js";import{i as U,r as _,Q as D,o as x,c as v,a as n,m as N,b as a,w as f,p as P,t as C,g as b,n as F,O as S,J as I}from"./app.js";import{P as u}from"./ps_constants.js";import{u as L,U as j}from"./UserUnReadMessageParameterHolder.js";import V from"./PsConfirmDialog2.js";import{P as B}from"./PsUtils.js";import J from"./PsLine.js";import{h as G}from"./moment.js";import{_ as Q}from"./plugin-vue_export-helper.js";class q{constructor(){this.userId="",this.deviceToken="",this.notiId="",this.notiType=""}NotiActionParameterHolder(){this.userId="",this.deviceToken="",this.notiId="",this.notiType=""}toMap(){const o={};return o.user_id=this.userId,o.device_token=this.deviceToken,o.noti_id=this.notiId,o.noti_type=this.notiType,o}}class K{constructor(){this.userId="",this.deviceToken=""}NotiParameterHolder(){this.userId="",this.deviceToken=""}toMap(){const o={};return o.user_id=this.userId,o.device_token=this.deviceToken,o}}const W={name:"NotiHorizontalItem",components:{PsLabel:M,PsDropdown:E,PsIcon:R,PsLoadingDialog:O,PsConfirmDialog2:V,PsLine:J},props:{noti:{type:T,default:new T},onClick:Function},setup(){const s=H(),e=z().getLoginUserId(),t=new q,h=new K,r=U();h.userId=e;const l=L(),d=new j;d.userId=e;const m=U(!1),y=U();async function k(i,p){r.value.openModal(),m.value=!1,t.userId=e,t.deviceToken=localStorage.deviceToken,t.notiId=i,t.notiType=p,await s.markAsRead(t,e),await s.resetNotiList(h),await l.postUserUnreadMessageCount(d),r.value.closeModal()}async function A(i,p){r.value.openModal(),m.value=!1,t.userId=e,t.deviceToken=localStorage.deviceToken,t.notiId=i,t.notiType=p,await s.markAsUnRead(t,e),await s.resetNotiList(h),await l.postUserUnreadMessageCount(d),r.value.closeModal()}async function g(i,p){r.value.openModal(),m.value=!1,t.userId=e,t.deviceToken=localStorage.deviceToken,t.notiId=i,t.notiType=p,await s.deleteNoti(t,e),await s.resetNotiList(h),await l.postUserUnreadMessageCount(d),r.value.closeModal()}async function w(i){i.type==u.PUSH_NOTI?S.Inertia.get(route("fe_notification_detail"),{notiId:i.id}):(i.type==u.CHAT_MESSAGE||i.type==u.OFFER_RECEIVED||i.type==u.OFFER_ACCEPTED||i.type==u.OFFER_REJECTED)&&(await k(i.id,i.type),r.value.openModal(),S.Inertia.get(route("fe_chat"),{buyer_user_id:i.buyerUserId,seller_user_id:i.sellerUserId,item_id:i.itemId,chat_flag:i.chatFlag}))}function c(i){y.value.openModal(I("noti_list__delete_title"),I("noti_list__delete_dialog"),I("chat__confirm"),I("chat__cancel"),()=>{g(i.id,i.type)},()=>{B.log("cancel")})}return{notiStore:s,showMenu:m,markAsRead:k,markAsUnRead:A,deleteNoti:g,ps_loading_dialog:r,ps_confirm_dialog:y,clickNoti:w,PsConst:u,deleteConfirm:c,moment:G}}},X={class:"flex flex-row justify-between h-[62px] sm:h-[100px]"},Y={class:"rounded-md bg-feAchromatic-50 dark_bg-feAchromatic-800"},Z={class:"sm:w-[100px] w-[62px] h-[62px] sm:h-[100px]"},$={key:0,alt:"Placeholder",width:"15px",height:"10px",class:"w-[62px] h-[62px] sm:w-full sm:h-full rounded-md"},ee={key:1,alt:"Placeholder",width:"15px",height:"10px",class:"w-[62px] h-[62px] sm:w-full sm:h-full rounded-md"},te={class:"flex flex-col ms-4 my-auto"},oe={class:"flex flex-col w-[62px] sm:w-[120px]"},ie={class:"flex justify-end w-full h-1/2"},se={class:"z-30"},ae={class:"h-1/2 w-full flex justify-end items-end p-1 sm:p-2"};function ne(s,o,e,t,h,r){var w;const l=_("ps-label"),d=_("ps-icon"),m=_("ps-line"),y=_("ps-dropdown"),k=_("ps-loading-dialog"),A=_("ps-confirm-dialog-2"),g=D("lazy");return x(),v("div",{class:F([e.noti.isRead=="0"?e.noti.type==t.PsConst.PUSH_NOTI?"bg-feSecondary-100":"bg-fePrimary-50 dark_bg-fePrimary-50":"bg-feSecondary-50","w-full cursor-pointer h-[62px] sm:h-[100px] dark_bg-feAchromatic-800 rounded"]),onClick:o[5]||(o[5]=c=>e.onClick!=null?e.onClick(e.noti):null)},[n("div",X,[n("div",{class:"flex-grow flex flex-row",onClick:o[0]||(o[0]=c=>t.clickNoti(e.noti))},[n("div",Y,[n("div",Z,[(w=e.noti)!=null&&w.senderCoverPhoto?N((x(),v("img",$,null,512)),[[g,{src:s.$page.props.thumb2xUrl+"/"+e.noti.senderCoverPhoto,loading:s.$page.props.sysImageUrl+"/loading_gif.gif",error:s.$page.props.sysImageUrl+"/default_photo.png"}]]):N((x(),v("img",ee,null,512)),[[g,{src:s.$page.props.thumb2xUrl+"/"+e.noti.defaultPhoto.imgPath,loading:s.$page.props.sysImageUrl+"/loading_gif.gif",error:s.$page.props.sysImageUrl+"/default_photo.png"}]])])]),n("div",te,[a(l,{class:"text-xxs sm:text-sm lg:text-base",textColor:e.noti.isRead=="0"?e.noti.type==t.PsConst.PUSH_NOTI?"text-feAchromatic-500 dark_text-feAchromatic-200":"text-feAchromatic-500":"text-feAchromatic-500 dark_text-feAchromatic-200",innerHTML:e.noti.message.length>75?e.noti.message.slice(0,75)+" ....":e.noti.message},null,8,["textColor","innerHTML"])])]),n("div",oe,[n("div",ie,[a(y,{horizontalAlign:"right",h:"h-auto ",class:"",onClick:o[4]||(o[4]=c=>t.showMenu=!t.showMenu)},{select:f(()=>[a(d,{name:"vertical-dot",w:"24",h:"24",textColor:e.noti.isRead=="0"?e.noti.type==t.PsConst.PUSH_NOTI?"text-feAchromatic-500 dark_text-feAchromatic-200":"text-feAchromatic-500":"text-feAchromatic-500 dark_text-feAchromatic-200",class:"mt-2 text-base me-1 cursor-pointer"},null,8,["textColor"])]),list:f(()=>[n("div",se,[e.noti.isRead=="0"&&e.noti.type!=t.PsConst.PUSH_NOTI?(x(),v("div",{key:0,onClick:o[1]||(o[1]=c=>t.markAsRead(e.noti.id,e.noti.type)),class:"w-56 flex justify-center items-center py-4 px-2 hover_bg-fePrimary-50 dark_hover_bg-feAchromatic-800 cursor-pointer"},[a(d,{name:"checkNoCircle",class:"mt-2"}),a(l,{class:"ms-2"},{default:f(()=>[P(C(s.$t("noti_horizontal_item__mark_as_read")),1)]),_:1})])):b("",!0),e.noti.isRead=="1"?(x(),v("div",{key:1,onClick:o[2]||(o[2]=c=>t.markAsUnRead(e.noti.id,e.noti.type)),class:"w-56 flex justify-center py-4 px-2 hover_bg-fePrimary-50 dark_hover_bg-feAchromatic-800 cursor-pointer items-center"},[a(d,{name:"checkNoCircle",class:"mt-2"}),a(l,{class:"ms-2"},{default:f(()=>[P(C(s.$t("noti_horizontal_item__mark_as_unread")),1)]),_:1})])):b("",!0),a(m,{class:"mx-4"}),n("div",{onClick:o[3]||(o[3]=c=>t.deleteConfirm(e.noti)),class:"w-56 flex justify-center py-4 px-2 hover_bg-fePrimary-50 dark_hover_bg-feAchromatic-800 cursor-pointer items-center"},[a(d,{name:"trash-alt"}),a(l,{class:"ms-2"},{default:f(()=>[P(C(s.$t("noti_horizontal_item__delete_noti")),1)]),_:1})])])]),_:1})]),n("div",ae,[a(l,{class:"text-3xs sm:text-xs truncate",textColor:e.noti.isRead=="0"?e.noti.type==t.PsConst.PUSH_NOTI?"text-feAchromatic-500 dark_text-feAchromatic-200":"text-feAchromatic-500":"text-feAchromatic-500 dark_text-feAchromatic-200"},{default:f(()=>[P(C(t.moment(e.noti.addedDate).format(s.$page.props.dateFormat)),1)]),_:1},8,["textColor"])])])]),a(k,{ref:"ps_loading_dialog"},null,512),a(A,{ref:"ps_confirm_dialog"},null,512)],2)}var re=Q(W,[["render",ne]]),we=Object.freeze(Object.defineProperty({__proto__:null,default:re},Symbol.toStringTag,{value:"Module"}));export{re as N,K as a,we as b};
