import U from"./PsCard2.js";import D from"./PsIcon2.js";import A from"./PsLabel2.js";import{u as k}from"./AppInfoStore.js";import{A as H}from"./AppInfoParameterHolder.js";import{u as V}from"./PsValueHolder.js";import{P as x}from"./PsValueStore.js";import{P as w}from"./ps_constants.js";import{C as j}from"./ChatHistory.js";import{r as I,Q as z,o as g,c as _,a as r,m as y,b as i,w as d,p as c,t as l,n as O,J as T,O as F}from"./app.js";import{h as P}from"./moment.js";import{f as L}from"./format.min.js";import{_ as N}from"./plugin-vue_export-helper.js";import"./PsApiService2.js";import"./PsObject.js";import"./DefaultPhoto.js";import"./Product.js";import"./Category.js";import"./DefaultIcon.js";import"./SubCategory.js";import"./ItemLocationTownship.js";import"./User.js";import"./RatingDetail.js";const B={name:"ChatHorizontalItem",components:{PsIcon:D,PsLabel:A,PsCard:U},props:{chathistory:{type:j},dateFormat:{type:String}},setup(o){x.psValueStore=V();const t=x().getLoginUserId(),n=new H;n.userId=t;const f=k();function b(e){return e.toString()=="0"?T("item_price__free"):L(f.appInfo.data.mobileSetting.price_format,e)}function s(e){F.Inertia.get(route("fe_chat"),{buyer_user_id:e.buyerUserId,seller_user_id:e.sellerUserId,item_id:e.itemId,chat_flag:w.CHAT_FROM_SELLER.toString()})}function u(e){let m=e.split(" ")[0],a=e.split(" ")[1],S=new Date().toISOString().split("T")[0];a=a.split(":"),a.pop(),a=a.join(":");let v=new Date,p=new Date(v);p.setDate(p.getDate()-1);let C=p.toISOString().split("T")[0];switch(!0){case m==S:return a;case m==C:return"Yesterday";default:return P(m).format(o.dateFormat)}}return{formatPrice:b,PsConst:w,appInfoStore:f,gotoDetail:s,chatTimeHistory:u,moment:P}}},E={class:"flex h-full"},M={class:"h-full w-[64px] sm:w-[100px] relative flex items-center"},R={alt:"Placeholder",class:"rounded-full bg-transparent h-16 w-16 sm:h-full sm:w-full border-2 border-feAchromatic-300"},Y={class:"absolute left-9 top-12 w-6 h-6 block sm:hidden"},J={alt:"Placeholder",class:"rounded-full w-full h-full border-2 border-feAchromatic-100"},Q={class:"grow px-4 py-1"},q={class:"flex justify-between items-center w-full"},G={class:"flex justify-between w-full"},K={key:0,class:"flex justify-center items-center font-normal text-sm rounded-full w-5 h-5 bg-fePrimary-600 text-feAchromatic-200"},W={key:1,class:"w-10 h-10 flex justify-center items-center"},X={class:"h-full hidden sm:block w-32"},Z={alt:"Placeholder",class:"rounded w-full h-full"};function $(o,h,t,n,f,b){const s=I("ps-label"),u=I("ps-icon"),e=z("lazy");return g(),_("div",{class:"cursor-pointer",onClick:h[0]||(h[0]=m=>n.gotoDetail(t.chathistory))},[r("div",{class:O(`h-[80px] sm:h-[100px] rounded-lg shadow-sm overflow-hidden mb-3 ${t.chathistory.buyerUnreadCount>0?"bg-feAchromatic-200":""} dark_bg-feSecondary-800`)},[r("div",E,[r("div",M,[y(r("img",R,null,512),[[e,{src:o.$page.props.thumb1xUrl+"/"+t.chathistory.seller.userCoverPhoto,loading:o.$page.props.sysImageUrl+"/loading_gif.gif",error:o.$page.props.sysImageUrl+"/default_photo.png"}]]),r("div",Y,[y(r("img",J,null,512),[[e,{src:o.$page.props.thumb1xUrl+"/"+t.chathistory.item.defaultPhoto.imgPath,loading:o.$page.props.sysImageUrl+"/loading_gif.gif",error:o.$page.props.sysImageUrl+"/default_photo.png"}]])])]),r("div",Q,[i(s,{textColor:"font-semibold text-fePrimary-500 text-xs sm:text-xl"},{default:d(()=>[c(l(t.chathistory?t.chathistory.seller.userName:""),1)]),_:1}),r("div",q,[i(s,{class:"font-medium text-xs sm:text-lg truncate"},{default:d(()=>[c(l(t.chathistory?t.chathistory.item.title:""),1)]),_:1}),i(s,{class:"text-xs truncate"},{default:d(()=>[c(l(t.chathistory.addedDateStr.includes("months")||t.chathistory.addedDateStr.includes("years")?n.moment(t.chathistory.addedDate).format(t.dateFormat):t.chathistory.addedDateStr),1)]),_:1})]),r("div",G,[i(s,{class:"font-normal text-sm text-feAchromatic-400",textColor:"text-feAchromatic-600"},{default:d(()=>[c(l(t.chathistory?t.chathistory.latestChatMessage:""),1)]),_:1}),t.chathistory.buyerUnreadCount>0?(g(),_("span",K,l(t.chathistory?t.chathistory.buyerUnreadCount:"0"),1)):(g(),_("div",W,[i(u,{name:"done_all",class:"text-feAchromatic-400",w:"24",h:"24"})]))])]),r("div",X,[y(r("img",Z,null,512),[[e,{src:o.$page.props.thumb1xUrl+"/"+t.chathistory.item.defaultPhoto.imgPath,loading:o.$page.props.sysImageUrl+"/loading_gif.gif",error:o.$page.props.sysImageUrl+"/default_photo.png"}]])])])],2)])}var Pt=N(B,[["render",$]]);export{Pt as default};
