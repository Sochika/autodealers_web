import{aC as ne,B as ce,Y as de,ba as ue,bb as me,H as _e,i as _,j as pe,J as d,r as c,Q as fe,o as l,c as g,b as s,w as i,a as r,ay as ge,t as w,F as Q,q as te,n as Y,p as N,g as C,f as U,m as re,O as be}from"./app.js";import he from"./PsButton2.js";import Se from"./PsLabel2.js";import ye from"./PsLabelHeader42.js";import ve from"./PsIcon2.js";import ke from"./PsInput2.js";import we from"./PsDropdown.js";import Ce from"./CustomCheckbox.js";import xe from"./PsBreadcrumb22.js";import Ie from"./PsWarningDialog32.js";import Pe from"./PsRouteLink.js";import Le from"./PsLoadingDialog3.js";import Ae from"./PsSuccessDialog22.js";import Ue from"./PsErrorDialog2.js";import{P as X}from"./ps_constants.js";import{u as Ee}from"./AppInfoStore.js";import{A as He}from"./AppInfoParameterHolder.js";import{u as Me}from"./SubCategoryStore.js";import{P as ae,b as Ne}from"./PsApiService2.js";import{A as ie}from"./ApiStatus.js";import{m as Be}from"./PsSepetetedStore.js";import{P as Ve}from"./PsValueStore.js";import{f as le}from"./index.esm.js";import"./PsNotificationBox.js";import Fe from"./PsContentContainer.js";import Te from"./PsFrontendLayout.js";import De from"./PsInputWithRightIcon2.js";import Oe from"./PsNoResult.js";import{P as B}from"./PsUtils.js";import{_ as Re}from"./plugin-vue_export-helper.js";import"./PsModal2.js";import"./vue-neat-modal.js";import"./PsLine.js";import"./PsLabelTitle2.js";import"./PsObject.js";import"./DefaultPhoto.js";import"./SubCategory.js";import"./DefaultIcon.js";import"./ProductStore.js";import"./ProductParameterHolder.js";import"./Product.js";import"./Category.js";import"./ItemLocationTownship.js";import"./User.js";import"./RatingDetail.js";import"./UserUnReadMessageParameterHolder.js";import"./vue-router.esm-bundler.js";import"./FooterView.js";import"./FooterLinkSection.js";import"./PsLink.js";import"./PsLabelCaption3.js";import"./PsNavTabBar.js";import"./PsDropdownSelect.js";import"./PsIconToggle.js";import"./LocationModal.js";import"./PsInputWithLeftIcon.js";import"./LocationParameterHolder.js";import"./ItemLocationTownshipStore.js";import"./PsNavBar.js";import"./UserStore.js";import"./UserListParameterHolder.js";import"./auth.esm.js";import"./PsConfirmDialog.js";import"./NotificationStore.js";import"./NotiUnRegisterHolder.js";const ze=Be(a=>ne(`subCategoryScribeStore/${a}`,()=>{const n=ce({value:!1});async function V(x,p){n.value=!0;const I=await ae.postSubCategoryScribe(new ie,x,p.toMap());return n.value=!1,I}async function e(x,p){n.value=!0;const I=await ae.isUserSubscribed(new ie,x,p);return n.value=!1,I}return{subCategoryScription:V,isUserSubscribed:e,loading:n}}));class qe{constructor(){this.userId="",this.catId="",this.subCatIds=[]}SubCategoryScribeParameterHolder(){return this.userId="",this.catId="",this.subCatIds=[],this}toMap(){return{user_id:this.userId,cat_id:this.catId,sub_cat_ids:this.subCatIds}}}de.add(ue,me);const je={name:"SubCategoryListView",components:{PsNoResult:Oe,PsButton:he,PsLabel:Se,PsLabelHeader4:ye,PsIcon:ve,PsRouteLink:Pe,PsInput:ke,PsDropdown:we,PsLoadingDialog:Le,PsErrorDialog:Ue,CustomCheckbox:Ce,PsSuccessDialog2:Ae,PsBreadcrumb2:xe,PsContentContainer:Fe,PsInputWithRightIcon:De,Head:_e,PsWarningDialog3:Ie},props:["query","mobileSetting","backendSetting"],layout:Te,setup(a){var M,J,oe,se;localStorage.catId="";const n=(M=a.query)==null?void 0:M.cat_id,V=(J=a.query)==null?void 0:J.cat_name,e=Me(),x=ze(),p=new qe,u=Ve().getLoginUserId(),y=new He;y.userId=u;const $=Ee(),f=_(!0),b=_(!1);e.limit=(se=(oe=a.mobileSetting)==null?void 0:oe.default_loading_limit)!=null?se:12;const v=_(),F=_();let T=_(""),D=_(""),E=_(!1),k=_([]),h=_([]);const P=_(),ee=_(),O=[{id:"0",orderBy:"name",orderType:X.FILTERING__ASC,name:"A to Z"},{id:"1",orderBy:"name",orderType:X.FILTERING__DESC,name:"Z to A"}];async function R(){}R(),e.paramHolder.catId=n,setTimeout(async()=>{await L()},1e3);function z(o){T.value=o.id,D.value=o.name,e.paramHolder.orderBy=o.orderBy,e.paramHolder.orderType=o.orderType,L()}async function q(){u&&u!=X.NO_LOGIN_USER?(b.value==!1&&F.value.openModal(d("subcat_subscribe__how_it_works"),d("subcat_subscribe__desc"),d("payment__ok"),()=>{B.log("Ok")},()=>{B.log("Cancel")}),E.value=!0):be.Inertia.get(route("login"))}const j=le.messaging.isSupported()?le.messaging():null;function G(o,m){!j||fetch("https://iid.googleapis.com/iid/v1/"+o+"/rel/topics/"+m,{method:"POST",headers:new Headers({Authorization:"key="+a.backendSetting.fcm_api_key})}).then(A=>{if(A.status<200||A.status>=400)throw"Error subscribing to topic: "+A.status+" - "+A.text();console.log('Subscribed to "'+m+'"')}).catch(A=>{console.error(A)})}async function K(){for(var o=0;o<k.value.length;o++)G(localStorage.deviceToken,k.value[o]);p.userId=u,p.catId=n,p.subCatIds=k.value,k.value=[];const m=await x.subCategoryScription(u,p);m.status==Ne.SUCCESS&&(await e.resetSearchSubCategoryList(u,e.paramHolder),b.value=!0,v.value.closeModal(),m.data.message=="SUBSCRIBED"?P.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}):m.data.message=="UNSUBSCIRBED"?P.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}):P.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}),E.value=!1,H())}function Z(){L()}async function H(){h.value=[],e.subCategoryList.data.forEach(o=>{o.isSubScribe=="1"&&h.value.push(o.id+"_FE")})}async function L(){var m;v.value.openModal(),await e.resetSearchSubCategoryList(u,e.paramHolder);const o=await x.isUserSubscribed("1",u);b.value=((m=o==null?void 0:o.data)==null?void 0:m.status)=="success",H(),v.value.closeModal(),f.value=!1}function W(){e.resetSearchSubCategoryList(u,e.paramHolder)}function t(o){if(h.value.includes(o)){let m=h.value.indexOf(o);h.value.splice(m,1)}else h.value.push(o)}function S(o){k.value=o}return pe(()=>{var o;f.value==!0&&((o=e.subCategoryList)==null?void 0:o.data)==null&&v.value.openModal()}),{updateValue:S,subCategoryStore:e,loadMore:W,subCategoryClick:t,catId:n,catName:V,currentsorting:O,sortingFilterClicked:z,activeSortingId:T,activeSortingName:D,ps_loading_dialog:v,searchClicked:Z,subCatScribe:q,scribe:E,submitScribe:K,checkedSelectedList:k,subscribedSubCatList:h,success:P,ps_error_dialog:ee,ps_warning_dialog:F,appInfoStore:$,PsConst:X,initial:f}},computed:{breadcrumb(){return[{label:d("item_list__home"),url:route("dashboard")},{label:d("sub_category_list__category"),url:route("fe_category.index")},{label:this.catName,color:"text-fePrimary-500"}]}}},Ge={class:"sm:mt-32 lg:mt-36 mt-28"},Ke={class:"flex flex-col sm:flex-row items-center justify-between mt-24 mb-5 sm:mb-6 lg:mb-8"},Ze={class:"w-full flex content-center items-center mt-7 sm:mt-0"},We={class:"flex-grow lg:w-72 xl:w-76 h-10 w-full sm:w-56 md:w-60"},Je={key:0,class:""},Qe={class:"hidden sm:block mx-4"},Ye={class:"rounded-md bg-feAchromatic-50 dark_bg-feSecondary-800 shadow-xs w-44"},Xe={class:"pt-2 z-30"},$e=["onClick"],et={key:1,class:"flex gap-4"},tt={class:"rounded-md bg-feAchromatic-50 dark_bg-feSecondary-800 shadow-xs w-44"},ot={class:"pt-2 z-30"},st=["onClick"],rt={class:"flex flex-col"},at={class:"flex flex-row mb-8"},it={class:"w-full flex flex-col"},lt={key:0,class:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-9 lg:grid-cols-12 md:gap-6 gap-4"},nt={class:"h-44 relative"},ct={class:"transform transition duration-500 hover:scale-110 w-full h-full object-cover",alt:""},dt={class:"flex justify-center absolute -bottom-6 w-full"},ut={class:"w-[52px] h-[52px] bg-feSecondary-50 dark_bg-feSecondary-800 p-3 rounded-full border-2 border-white"},mt={alt:"Placeholder",class:"transform transition duration-500 hover:scale-110"},_t={class:"h-20"},pt={class:"absolute -top-3 -right-3 w-6 h-6"};function ft(a,n,V,e,x,p){const I=c("Head"),u=c("ps-breadcrumb-2"),y=c("ps-icon"),$=c("ps-input-with-right-icon"),f=c("ps-button"),b=c("ps-label"),v=c("ps-dropdown"),F=c("ps-route-link"),T=c("custom-checkbox"),D=c("ps-no-result"),E=c("ps-content-container"),k=c("ps-loading-dialog"),h=c("ps-success-dialog-2"),P=c("ps-error-dialog"),ee=c("ps-warning-dialog-3"),O=fe("lazy");return l(),g(Q,null,[s(I,{title:a.$t("sub_category_list__category")},null,8,["title"]),s(E,null,{content:i(()=>{var R,z,q,j,G,K,Z,H,L,W;return[r("div",Ge,[r("div",Ke,[s(u,{items:p.breadcrumb,class:""},null,8,["items"]),r("div",Ze,[r("div",We,[s($,{onKeyup:ge(e.searchClicked,["enter"]),value:e.subCategoryStore.paramHolder.keyword,"onUpdate:value":n[0]||(n[0]=t=>e.subCategoryStore.paramHolder.keyword=t),class:"",placeholder:a.$t("sub_category_list__search")},{icon:i(()=>[s(y,{name:"search",class:"cursor-pointer"})]),_:1},8,["onKeyup","value","placeholder"])]),((j=(q=(z=(R=e.appInfoStore)==null?void 0:R.appInfo)==null?void 0:z.data)==null?void 0:q.psAppSetting)==null?void 0:j.isSubcatSubscription)==e.PsConst.ZERO?(l(),g("div",Je,[s(v,{horizontalAlign:"right",h:"h-auto",class:"ms-4 h-10 w-auto sm:w-36"},{select:i(()=>[s(b,{class:"rounded h-full"},{default:i(()=>[s(f,{class:"h-10"},{default:i(()=>[s(y,{name:"filter"}),r("span",Qe,w(e.activeSortingName?e.activeSortingName:"Sort"),1),s(y,{class:"hidden sm:flex",name:"downChervon"})]),_:1})]),_:1})]),list:i(()=>[r("div",Ye,[r("div",Xe,[r("div",null,[(l(!0),g(Q,null,te(e.currentsorting,t=>(l(),g("div",{key:t.id,class:"w-72 flex py-4 px-2 hover_bg-fePrimary-50 dark_hover_bg-feSecondary-500 cursor-pointer items-center",onClick:S=>e.sortingFilterClicked(t)},[s(b,{class:Y(["ms-2",t.id==e.activeSortingId?" font-medium":"font-light"])},{default:i(()=>[N(w(a.$t("review_entry__title"))+": "+w(t.name),1)]),_:2},1032,["class"])],8,$e))),128))])])])]),_:1})])):C("",!0),((H=(Z=(K=(G=e.appInfoStore)==null?void 0:G.appInfo)==null?void 0:K.data)==null?void 0:Z.psAppSetting)==null?void 0:H.isSubcatSubscription)==e.PsConst.ONE?(l(),g("div",et,[s(v,{horizontalAlign:"right",h:"h-auto",class:"ms-4"},{select:i(()=>[s(b,{class:"rounded h-full"},{default:i(()=>[s(f,{class:"h-10 w-10",padding:"p-2",colors:"dg-feAchromatic-50 dark_bg-feSecondary-800 text-fePrimary-500 hover_text-feAchromatic-50",focus:"focus:outline-none focus_bg-feAchromatic-50 focus_text-fePrimary-500",border:"border border-feSecondary-200 dark_border-feSecondary-800",shadows:"shadow-sm"},{default:i(()=>[s(y,{name:"filter"})]),_:1})]),_:1})]),list:i(()=>[r("div",tt,[r("div",ot,[r("div",null,[(l(!0),g(Q,null,te(e.currentsorting,t=>(l(),g("div",{key:t.id,class:"w-72 flex py-4 px-2 hover_bg-fePrimary-50 dark_hover_bg-feSecondary-500 cursor-pointer items-center",onClick:S=>e.sortingFilterClicked(t)},[s(b,{class:Y(["ms-2",t.id==e.activeSortingId?" font-medium":"font-light"])},{default:i(()=>[N(w(a.$t("review_entry__title"))+": "+w(t.name),1)]),_:2},1032,["class"])],8,st))),128))])])])]),_:1}),e.scribe?C("",!0):(l(),U(f,{key:0,padding:"p-2",onClick:e.subCatScribe},{default:i(()=>[s(y,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bell-outline",h:"24",w:"24",viewBox:"0 -2 18 23"})]),_:1},8,["onClick"])),e.scribe?(l(),U(f,{key:1,padding:"p-2",onClick:e.submitScribe},{default:i(()=>[s(y,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bluemark",h:"24",w:"24"})]),_:1},8,["onClick"])):C("",!0)])):C("",!0)])]),r("div",rt,[r("div",at,[r("div",it,[e.subCategoryStore.subCategoryList&&e.subCategoryStore.subCategoryList.data!=null?(l(),g("div",lt,[(l(!0),g(Q,null,te((L=e.subCategoryStore.subCategoryList)==null?void 0:L.data,t=>(l(),g("div",{class:"relative w-full col-span-4 sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-3",key:t.id},[s(F,{class:"flex-grow",to:{name:"fe_item_list",query:{cat_id:e.catId,cat_name:e.catName,sub_cat_id:t.id,sub_cat_name:t.name}}},{default:i(()=>{var S,M;return[r("div",{class:Y(["text-center cursor-pointer w-full lg:py-0 overflow-hidden lg:px-0 px-2 py-2 bg-feSecondary-50 dark_bg-feSecondary-800 rounded-lg",e.scribe&&e.subscribedSubCatList.filter(J=>J==t.id+"_FE").length==1?"border-2 border-fePrimary-500":""])},[r("div",nt,[re(r("img",ct,null,512),[[O,{src:a.$page.props.thumb3xUrl+"/"+((S=t==null?void 0:t.defaultPhoto)==null?void 0:S.imgPath),loading:a.$page.props.sysImageUrl+"/loading_gif.gif",error:a.$page.props.sysImageUrl+"/default_photo.png"}]]),r("div",dt,[r("div",ut,[re(r("img",mt,null,512),[[O,{src:a.$page.props.thumb2xUrl+"/"+((M=t==null?void 0:t.defaultIcon)==null?void 0:M.imgPath),loading:a.$page.props.sysImageUrl+"/loading_gif.gif",error:a.$page.props.sysImageUrl+"/default_photo.png"}]])])])]),r("div",_t,[s(b,{class:"peer-checked/draft:text-sky-500 pt-9 lg:text-base sm:text-sm text-xxs",textColor:""},{default:i(()=>[N(w(t.name.length>20?t.name.slice(0,20)+"...":t.name),1)]),_:2},1024)])],2)]}),_:2},1032,["to"]),r("div",pt,[e.scribe?(l(),U(T,{key:0,isScribe:t.isSubScribe,checked:t.id+"_FE",value:t.id+"_FE",onUpdateSelectedValue:e.updateValue,selectedValue:e.checkedSelectedList,"onUpdate:selectedValue":n[1]||(n[1]=S=>e.checkedSelectedList=S),onClick:S=>e.subCategoryClick(t.id+"_FE")},null,8,["isScribe","checked","value","onUpdateSelectedValue","selectedValue","onClick"])):C("",!0)])]))),128))])):C("",!0),e.subCategoryStore.loading.value==!1&&((W=e.subCategoryStore.subCategoryList)==null?void 0:W.data)==null&&e.initial==!1?(l(),U(D,{key:1,onOnClick:e.loadMore,class:"my-6"},null,8,["onOnClick"])):C("",!0),e.subCategoryStore.loading.value==!1&&e.initial==!1?(l(),U(f,{key:2,class:Y(["w-60 mx-auto mt-8",e.subCategoryStore.isNoMoreRecord.value?"hidden":""]),onClick:e.loadMore},{default:i(()=>[N(w(a.$t("sub_category_list__load_more")),1)]),_:1},8,["onClick","class"])):e.initial==!1?(l(),U(f,{key:3,class:"w-60 mx-auto mt-8",onClick:e.loadMore,disabled:!0},{default:i(()=>[N(w(a.$t("sub_category_list__loading")),1)]),_:1},8,["onClick"])):C("",!0)])])])])]}),_:1}),s(k,{ref:"ps_loading_dialog",class:"z-40"},null,512),s(h,{ref:"success"},null,512),s(P,{ref:"ps_error_dialog"},null,512),s(ee,{ref:"ps_warning_dialog"},null,512)],64)}var Lo=Re(je,[["render",ft]]);export{Lo as default};
