import{aA as E,aB as F,d as U,i as l,r as u,o as b,f as I,w as r,b as f,p as h,t as g,g as L,m as G,ak as H,a as V}from"./app.js";import{A as R,O as T}from"./index.js";import W from"./PsModal2.js";import j from"./PsButton2.js";import K from"./PsLabel2.js";import{P as $}from"./PsUtils.js";import{u as q}from"./AppInfoStore.js";import{A as J}from"./AppInfoParameterHolder.js";import{P as Q}from"./PsValueStore.js";import{P as X}from"./ps_constants.js";import{_ as Y}from"./plugin-vue_export-helper.js";import"./vue-neat-modal.js";import"./PsLine.js";import"./PsApiService2.js";import"./PsObject.js";import"./DefaultPhoto.js";const Z=E(()=>F(()=>import("./OpenStreetMap.js"),["OpenStreetMap.js","OpenStreetMap.css","app.js","app.css","Control.Geocoder.js","Control.Geocoder.css","plugin-vue_export-helper.js"])),x=U({name:"MapWithCircleFilterModal",components:{PsModal:W,GoogleMap:R,Circle:T,PsButton:j,PsLabel:K,OpenStreetMap:Z},setup(){const e=l(),t=l(),a=l(),y=1610;let P;const c=l(),i=l(),s=l(1),o=l({position:{lat:40.876945,lng:77.387978},draggable:!0}),v=Q().getLoginUserId(),_=q(),m=new J;m.userId=v;const p=l({key:"000",center:o.value.position,zoom:15});async function C(){p.value.key=_.appInfo.data.frontendConfigSetting.mapKey}C();function k(){a.value!=null?(c.value=a.value.circle.component.value.getCenter().lat(),i.value=a.value.circle.component.value.getCenter().lng()):(c.value=o.value.position.lat,i.value=o.value.position.lng),P(c.value,i.value,s.value),e.value.toggle(!1)}function d(n,S,w,z){n!=0&&(o.value.position.lat=n),S!=0&&(o.value.position.lng=S),n!=0&&S!=0&&(p.value.center=o.value.position,t.value!=null&&t.value.center!=null&&(t.value.map.setCenter(t.value.map.center),a.value.circle.component.value.setCenter(o.value.position))),P=z,w!=0&&(s.value=w),e.value.toggle(!0)}function O(){a.value.circle.component.value.setRadius(s.value*y)}const A={editable:!1,center:o.value.position,radius:s.value*y,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,draggable:!0,crossOnDrag:!1};function D(n){c.value=n.latLng.lat(),i.value=n.latLng.lng()}function N(){a.value!=null&&($.log(a.value.circle.component.value.getRadius()),$.log(a.value.circle.component.value.getCenter().lat()+" <> "+a.value.circle.component.value.getCenter().lng()))}function B(n){o.value.position.lat=n.lat.toString(),o.value.position.lng=n.lng.toString()}return{psmodal:e,updateLeafletCoordinates:B,mcenter:o,map:p,openModal:d,map_ref:t,pickedLocation:k,cir_ref:a,circleCenter:A,radius_changed:N,dragend:D,radius:s,rangeChanged:O,appInfoStore:_,PsConst:X}}}),ee={class:"flex justify-between"};function oe(e,t,a,y,P,c){const i=u("ps-label"),s=u("Circle"),o=u("GoogleMap"),M=u("open-street-map"),v=u("ps-button"),_=u("ps-modal");return b(),I(_,{ref:"psmodal",line:"hidden",bodyHeight:"max-h-76",isClickOut:!0},{title:r(()=>[f(i,{class:"mb-2"},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__title")),1)]),_:1})]),body:r(()=>{var m,p,C,k;return[((p=(m=e.appInfoStore)==null?void 0:m.appInfo)==null?void 0:p.data.frontendConfigSetting.googleMap)==e.PsConst.ONE?(b(),I(o,{key:0,id:"map",ref:"map_ref","api-key":e.map.key,draggable:!0,center:e.map.center,zoom:e.map.zoom,style:{width:"100%",height:"300px"}},{default:r(()=>[f(s,{id:"circle",options:e.circleCenter,ref:"cir_ref",onDragend:e.dragend,onClick:e.radius_changed},null,8,["options","onDragend","onClick"])]),_:1},8,["api-key","center","zoom"])):L("",!0),((k=(C=e.appInfoStore)==null?void 0:C.appInfo)==null?void 0:k.data.frontendConfigSetting.openStreetMap)==e.PsConst.ONE?(b(),I(M,{key:1,dir:e.$page.props.dir,class:"h-68",lat:e.map.center.lat,lng:e.map.center.lng,dragValue:!1,onChange:e.updateLeafletCoordinates},null,8,["dir","lat","lng","onChange"])):L("",!0),f(i,{class:"mt-1"},{default:r(()=>[h(g(e.radius)+" "+g(e.$t("map_with_circle_filter_moadl__miles")),1)]),_:1}),G(V("input",{type:"range",id:"vol",name:"vol",min:"1",max:"300","onUpdate:modelValue":t[0]||(t[0]=d=>e.radius=d),onInput:t[1]||(t[1]=(...d)=>e.rangeChanged&&e.rangeChanged(...d)),class:"w-full"},null,544),[[H,e.radius]])]}),footer:r(()=>[V("div",ee,[f(v,{onClick:t[2]||(t[2]=m=>e.psmodal.toggle(!1)),class:"",theme:"btn-second"},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__cancel")),1)]),_:1}),f(v,{onClick:e.pickedLocation},{default:r(()=>[h(g(e.$t("map_with_circle_filter_moadl__pick_location")),1)]),_:1},8,["onClick"])])]),_:1},512)}var Ce=Y(x,[["render",oe]]);export{Ce as default};
