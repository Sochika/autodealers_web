import{bD as ne,y as ce,Z as de,i as _,j as ue,z as d,o as i,c as g,b as r,w as l,a as s,a0 as me,f as w,t as C,F as Q,s as oe,n as X,q as M,g as x,m as se,O as _e,r as c,E as pe}from"./app.df1b8390.js";import fe from"./PsButton.935d57c3.js";import ge from"./PsLabel.3935ab2c.js";import be from"./PsLabelHeader4.6663f7f2.js";import he from"./PsIcon.0697a0d8.js";import Se from"./PsInput.699f2c15.js";import ye from"./PsDropdown.e8bb7988.js";import ve from"./CustomCheckbox.73a5527f.js";import ke from"./PsBreadcrumb2.43f3d05c.js";import we from"./PsWarningDialog3.3677285c.js";import Ce from"./PsRouteLink.14f8a093.js";import xe from"./PsLoadingDialog.16642bee.js";import Ie from"./PsSuccessDialog2.20072078.js";import Pe from"./PsErrorDialog.7e6a8a91.js";import{P as Y}from"./ps_constants.deaae373.js";import{u as Le}from"./AppInfoStore.4b2c5718.js";import{A as Ae}from"./AppInfoParameterHolder.e24d894d.js";import{u as Ue}from"./SubCategoryStore.97e57f73.js";import{P as ae,b as Ee}from"./PsApiService.317e88ef.js";import{A as ie}from"./ApiStatus.5720ba0b.js";import{m as He}from"./PsSepetetedStore.9a31ac47.js";import{P as Ne}from"./PsValueStore.08b5513c.js";import{f as le}from"./index.esm.159b9749.js";import"./PsNotificationBox.cc3868e0.js";import Me from"./PsContentContainer.2eb168de.js";import Be from"./PsFrontendLayout.9c0ecc46.js";import Ve from"./PsInputWithRightIcon.d74f8e6b.js";import De from"./PsNoResult.8f88a170.js";import{P as B}from"./PsUtils.2215fd6f.js";import{_ as Fe}from"./plugin-vue_export-helper.21dcd24c.js";import"./PsModal.11d3d0c2.js";import"./vue-neat-modal.fd4a8f96.js";import"./PsLine.40e0def3.js";import"./PsLabelTitle.7685c780.js";import"./PsObject.a17ef38f.js";import"./DefaultPhoto.cc755f93.js";import"./SubCategory.1b4176e0.js";import"./DefaultIcon.e76b39a5.js";import"./ProductStore.186e332b.js";import"./ProductParameterHolder.b3159892.js";import"./Product.dc190b28.js";import"./Category.7c65464b.js";import"./ItemLocationTownship.94979fe0.js";import"./User.ca420d1f.js";import"./RatingDetail.291ad5d1.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./UserUnReadMessageParameterHolder.1742bc34.js";import"./FooterView.97dc7826.js";import"./FooterLinkSection.746092c6.js";import"./PsLink.0ee2fc53.js";import"./PsLabelCaption.a3843f8e.js";import"./PsNavTabBar.6c5f8913.js";import"./PsDropdownSelect.a0554af8.js";import"./PsIconToggle.27dcede3.js";import"./LocationModal.e33ab72c.js";import"./PsInputWithLeftIcon.bd6285ce.js";import"./LocationParameterHolder.5c9d98a1.js";import"./ItemLocationTownshipStore.9af11738.js";import"./PsNavBar.9d521488.js";import"./UserStore.5c2fdd50.js";import"./UserListParameterHolder.d110b747.js";import"./auth.esm.925cebae.js";import"./PsConfirmDialog.d57ea5b9.js";import"./NotificationStore.987a5d48.js";import"./NotiUnRegisterHolder.eefb692e.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";const Te=He(a=>ne(`subCategoryScribeStore/${a}`,()=>{const n=ce({value:!1});async function V(I,p){n.value=!0;const P=await ae.postSubCategoryScribe(new ie,I,p.toMap());return n.value=!1,P}async function e(I,p){n.value=!0;const P=await ae.isUserSubscribed(new ie,I,p);return n.value=!1,P}return{subCategoryScription:V,isUserSubscribed:e,loading:n}}));class Oe{constructor(){this.userId="",this.catId="",this.subCatIds=[]}SubCategoryScribeParameterHolder(){return this.userId="",this.catId="",this.subCatIds=[],this}toMap(){return{user_id:this.userId,cat_id:this.catId,sub_cat_ids:this.subCatIds}}}const ze={name:"SubCategoryListView",components:{PsNoResult:De,PsButton:fe,PsLabel:ge,PsLabelHeader4:be,PsIcon:he,PsRouteLink:Ce,PsInput:Se,PsDropdown:ye,PsLoadingDialog:xe,PsErrorDialog:Pe,CustomCheckbox:ve,PsSuccessDialog2:Ie,PsBreadcrumb2:ke,PsContentContainer:Me,PsInputWithRightIcon:Ve,Head:de,PsWarningDialog3:we},props:["query","mobileSetting","backendSetting"],layout:Be,setup(a){var N,J,te,re;localStorage.catId="";const n=(N=a.query)==null?void 0:N.cat_id,V=(J=a.query)==null?void 0:J.cat_name,e=Ue(),I=Te(),p=new Oe,u=Ne().getLoginUserId(),b=new Ae;b.userId=u;const $=Le(),f=_(!0),h=_(!1);e.limit=(re=(te=a.mobileSetting)==null?void 0:te.default_loading_limit)!=null?re:12;const v=_(),D=_();let F=_(""),T=_(""),E=_(!1),k=_([]),S=_([]);const L=_(),ee=_(),O=[{id:"0",orderBy:"name",orderType:Y.FILTERING__ASC,name:"A to Z"},{id:"1",orderBy:"name",orderType:Y.FILTERING__DESC,name:"Z to A"}];async function z(){}z(),e.paramHolder.catId=n,setTimeout(async()=>{await A()},1e3);function R(t){F.value=t.id,T.value=t.name,e.paramHolder.orderBy=t.orderBy,e.paramHolder.orderType=t.orderType,A()}async function q(){u&&u!=Y.NO_LOGIN_USER?(h.value==!1&&D.value.openModal(d("subcat_subscribe__how_it_works"),d("subcat_subscribe__desc"),d("payment__ok"),()=>{B.log("Ok")},()=>{B.log("Cancel")}),E.value=!0):_e.get(route("login"))}const j=le.messaging.isSupported()?le.messaging():null;function Z(t,m){!j||fetch("https://iid.googleapis.com/iid/v1/"+t+"/rel/topics/"+m,{method:"POST",headers:new Headers({Authorization:"key="+a.backendSetting.fcm_api_key})}).then(U=>{if(U.status<200||U.status>=400)throw"Error subscribing to topic: "+U.status+" - "+U.text();console.log('Subscribed to "'+m+'"')}).catch(U=>{console.error(U)})}async function G(){for(var t=0;t<k.value.length;t++)Z(localStorage.deviceToken,k.value[t]);p.userId=u,p.catId=n,p.subCatIds=k.value,k.value=[];const m=await I.subCategoryScription(u,p);m.status==Ee.SUCCESS&&(await e.resetSearchSubCategoryList(u,e.paramHolder),h.value=!0,v.value.closeModal(),m.data.message=="SUBSCRIBED"?L.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}):m.data.message=="UNSUBSCIRBED"?L.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}):L.value.openModal(d("subcategory__subscription_status"),d("subcategory__subscription_message"),d("core_fe__done"),()=>{B.log("ok")}),E.value=!1,H())}function K(){A()}async function H(){S.value=[],e.subCategoryList.data.forEach(t=>{t.isSubScribe=="1"&&S.value.push(t.id+"_FE")})}async function A(){var m;v.value.openModal(),await e.resetSearchSubCategoryList(u,e.paramHolder);const t=await I.isUserSubscribed("1",u);h.value=((m=t==null?void 0:t.data)==null?void 0:m.status)=="success",H(),v.value.closeModal(),f.value=!1}function W(){e.resetSearchSubCategoryList(u,e.paramHolder)}function o(t){if(S.value.includes(t)){let m=S.value.indexOf(t);S.value.splice(m,1)}else S.value.push(t)}function y(t){k.value=t}return ue(()=>{var t;f.value==!0&&((t=e.subCategoryList)==null?void 0:t.data)==null&&v.value.openModal()}),{updateValue:y,subCategoryStore:e,loadMore:W,subCategoryClick:o,catId:n,catName:V,currentsorting:O,sortingFilterClicked:R,activeSortingId:F,activeSortingName:T,ps_loading_dialog:v,searchClicked:K,subCatScribe:q,scribe:E,submitScribe:G,checkedSelectedList:k,subscribedSubCatList:S,success:L,ps_error_dialog:ee,ps_warning_dialog:D,appInfoStore:$,PsConst:Y,initial:f}},computed:{breadcrumb(){return[{label:d("item_list__home"),url:route("dashboard")},{label:d("sub_category_list__category"),url:route("fe_category.index")},{label:this.catName,color:"text-fePrimary-500"}]}}},Re={class:"sm:mt-32 lg:mt-36 mt-28"},qe={class:"flex flex-col sm:flex-row items-center justify-between mt-24 mb-5 sm:mb-6 lg:mb-8"},je={class:"w-full flex content-center items-center mt-7 sm:mt-0"},Ze={class:"flex-grow lg:w-72 xl:w-76 h-10 w-full sm:w-56 md:w-60"},Ge={key:0,class:""},Ke={class:"hidden sm:block mx-4"},We={class:"rounded-md bg-feAchromatic-50 dark:bg-feSecondary-800 shadow-xs w-44"},Je={class:"pt-2 z-30"},Qe=["onClick"],Xe={key:1,class:"flex gap-4"},Ye={class:"rounded-md bg-feAchromatic-50 dark:bg-feSecondary-800 shadow-xs w-44"},$e={class:"pt-2 z-30"},eo=["onClick"],oo={class:"flex flex-col"},to={class:"flex flex-row mb-8"},ro={class:"w-full flex flex-col"},so={key:0,class:"grid grid-cols-4 sm:grid-cols-4 md:grid-cols-9 lg:grid-cols-12 md:gap-6 gap-4"},ao={class:"h-44 relative"},io={class:"transform transition duration-500 hover:scale-110 w-full h-full object-cover",alt:""},lo={class:"flex justify-center absolute -bottom-6 w-full"},no={class:"w-[52px] h-[52px] bg-feSecondary-50 dark:bg-feSecondary-800 p-3 rounded-full border-2 border-white"},co={alt:"Placeholder",class:"transform transition duration-500 hover:scale-110"},uo={class:"h-20"},mo={class:"absolute -top-3 -right-3 w-6 h-6"};function _o(a,n,V,e,I,p){const P=c("Head"),u=c("ps-breadcrumb-2"),b=c("ps-icon"),$=c("ps-input-with-right-icon"),f=c("ps-button"),h=c("ps-label"),v=c("ps-dropdown"),D=c("ps-route-link"),F=c("custom-checkbox"),T=c("ps-no-result"),E=c("ps-content-container"),k=c("ps-loading-dialog"),S=c("ps-success-dialog-2"),L=c("ps-error-dialog"),ee=c("ps-warning-dialog-3"),O=pe("lazy");return i(),g(Q,null,[r(P,{title:a.$t("sub_category_list__category")},null,8,["title"]),r(E,null,{content:l(()=>{var z,R,q,j,Z,G,K,H,A,W;return[s("div",Re,[s("div",qe,[r(u,{items:p.breadcrumb,class:""},null,8,["items"]),s("div",je,[s("div",Ze,[r($,{onKeyup:me(e.searchClicked,["enter"]),value:e.subCategoryStore.paramHolder.keyword,"onUpdate:value":n[1]||(n[1]=o=>e.subCategoryStore.paramHolder.keyword=o),class:"",placeholder:a.$t("sub_category_list__search")},{icon:l(()=>[e.subCategoryStore.paramHolder.keyword==""?(i(),w(b,{key:0,name:"search",class:"cursor-pointer"})):(i(),w(b,{key:1,onClick:n[0]||(n[0]=o=>[e.subCategoryStore.paramHolder.keyword="",e.searchClicked()]),name:"cross",class:"cursor-pointer"}))]),_:1},8,["onKeyup","value","placeholder"])]),((j=(q=(R=(z=e.appInfoStore)==null?void 0:z.appInfo)==null?void 0:R.data)==null?void 0:q.psAppSetting)==null?void 0:j.isSubcatSubscription)==e.PsConst.ZERO?(i(),g("div",Ge,[r(v,{horizontalAlign:"right",h:"h-auto",class:"ms-4 h-10 w-auto sm:w-36"},{select:l(()=>[r(h,{class:"rounded h-full"},{default:l(()=>[r(f,{class:"h-10"},{default:l(()=>[r(b,{name:"filter"}),s("span",Ke,C(e.activeSortingName?e.activeSortingName:"Sort"),1),r(b,{class:"hidden sm:flex",name:"downChervon"})]),_:1})]),_:1})]),list:l(()=>[s("div",We,[s("div",Je,[s("div",null,[(i(!0),g(Q,null,oe(e.currentsorting,o=>(i(),g("div",{key:o.id,class:"w-72 flex py-4 px-2 hover:bg-fePrimary-50 dark:hover:bg-feSecondary-500 cursor-pointer items-center",onClick:y=>e.sortingFilterClicked(o)},[r(h,{class:X(["ms-2",o.id==e.activeSortingId?" font-medium":"font-light"])},{default:l(()=>[M(C(a.$t("review_entry__title"))+": "+C(o.name),1)]),_:2},1032,["class"])],8,Qe))),128))])])])]),_:1})])):x("",!0),((H=(K=(G=(Z=e.appInfoStore)==null?void 0:Z.appInfo)==null?void 0:G.data)==null?void 0:K.psAppSetting)==null?void 0:H.isSubcatSubscription)==e.PsConst.ONE?(i(),g("div",Xe,[r(v,{horizontalAlign:"right",h:"h-auto",class:"ms-4"},{select:l(()=>[r(h,{class:"rounded h-full"},{default:l(()=>[r(f,{class:"h-10 w-10",padding:"p-2",colors:"dg-feAchromatic-50 dark:bg-feSecondary-800 text-fePrimary-500 hover:text-feAchromatic-50",focus:"focus:outline-none focus:bg-feAchromatic-50 focus:text-fePrimary-500",border:"border border-feSecondary-200 dark:border-feSecondary-800",shadows:"shadow-sm"},{default:l(()=>[r(b,{name:"filter"})]),_:1})]),_:1})]),list:l(()=>[s("div",Ye,[s("div",$e,[s("div",null,[(i(!0),g(Q,null,oe(e.currentsorting,o=>(i(),g("div",{key:o.id,class:"w-72 flex py-4 px-2 hover:bg-fePrimary-50 dark:hover:bg-feSecondary-500 cursor-pointer items-center",onClick:y=>e.sortingFilterClicked(o)},[r(h,{class:X(["ms-2",o.id==e.activeSortingId?" font-medium":"font-light"])},{default:l(()=>[M(C(a.$t("review_entry__title"))+": "+C(o.name),1)]),_:2},1032,["class"])],8,eo))),128))])])])]),_:1}),e.scribe?x("",!0):(i(),w(f,{key:0,padding:"p-2",onClick:e.subCatScribe},{default:l(()=>[r(b,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bell-outline",h:"24",w:"24",viewBox:"0 -2 18 23"})]),_:1},8,["onClick"])),e.scribe?(i(),w(f,{key:1,padding:"p-2",onClick:e.submitScribe},{default:l(()=>[r(b,{class:"cursor-pointer",textColor:"text-feAchromatic-50",name:"bluemark",h:"24",w:"24"})]),_:1},8,["onClick"])):x("",!0)])):x("",!0)])]),s("div",oo,[s("div",to,[s("div",ro,[e.subCategoryStore.subCategoryList&&e.subCategoryStore.subCategoryList.data!=null?(i(),g("div",so,[(i(!0),g(Q,null,oe((A=e.subCategoryStore.subCategoryList)==null?void 0:A.data,o=>(i(),g("div",{class:"relative w-full col-span-4 sm:col-span-2 md:col-span-3 lg:col-span-4 xl:col-span-3",key:o.id},[r(D,{class:"flex-grow",to:{name:"fe_item_list",query:{cat_id:e.catId,cat_name:e.catName,sub_cat_id:o.id,sub_cat_name:o.name}}},{default:l(()=>{var y,N;return[s("div",{class:X(["text-center cursor-pointer w-full lg:py-0 overflow-hidden lg:px-0 px-2 py-2 bg-feSecondary-50 dark:bg-feSecondary-800 rounded-lg",e.scribe&&e.subscribedSubCatList.filter(J=>J==o.id+"_FE").length==1?"border-2 border-fePrimary-500":""])},[s("div",ao,[se(s("img",io,null,512),[[O,{src:a.$page.props.thumb3xUrl+"/"+((y=o==null?void 0:o.defaultPhoto)==null?void 0:y.imgPath),loading:a.$page.props.sysImageUrl+"/loading_gif.gif",error:a.$page.props.sysImageUrl+"/default_photo.png"}]]),s("div",lo,[s("div",no,[se(s("img",co,null,512),[[O,{src:a.$page.props.thumb2xUrl+"/"+((N=o==null?void 0:o.defaultIcon)==null?void 0:N.imgPath),loading:a.$page.props.sysImageUrl+"/loading_gif.gif",error:a.$page.props.sysImageUrl+"/default_photo.png"}]])])])]),s("div",uo,[r(h,{class:"peer-checked/draft:text-sky-500 pt-9 lg:text-base sm:text-sm text-xxs",textColor:""},{default:l(()=>[M(C(o.name.length>20?o.name.slice(0,20)+"...":o.name),1)]),_:2},1024)])],2)]}),_:2},1032,["to"]),s("div",mo,[e.scribe?(i(),w(F,{key:0,isScribe:o.isSubScribe,checked:o.id+"_FE",value:o.id+"_FE",onUpdateSelectedValue:e.updateValue,selectedValue:e.checkedSelectedList,"onUpdate:selectedValue":n[2]||(n[2]=y=>e.checkedSelectedList=y),onClick:y=>e.subCategoryClick(o.id+"_FE")},null,8,["isScribe","checked","value","onUpdateSelectedValue","selectedValue","onClick"])):x("",!0)])]))),128))])):x("",!0),e.subCategoryStore.loading.value==!1&&((W=e.subCategoryStore.subCategoryList)==null?void 0:W.data)==null&&e.initial==!1?(i(),w(T,{key:1,onOnClick:e.loadMore,class:"my-6"},null,8,["onOnClick"])):x("",!0),e.subCategoryStore.loading.value==!1&&e.initial==!1?(i(),w(f,{key:2,class:X(["w-60 mx-auto mt-8",e.subCategoryStore.isNoMoreRecord.value?"hidden":""]),onClick:e.loadMore},{default:l(()=>[M(C(a.$t("sub_category_list__load_more")),1)]),_:1},8,["onClick","class"])):e.initial==!1?(i(),w(f,{key:3,class:"w-60 mx-auto mt-8",onClick:e.loadMore,disabled:!0},{default:l(()=>[M(C(a.$t("sub_category_list__loading")),1)]),_:1},8,["onClick"])):x("",!0)])])])])]}),_:1}),r(k,{ref:"ps_loading_dialog",class:"z-40"},null,512),r(S,{ref:"success"},null,512),r(L,{ref:"ps_error_dialog"},null,512),r(ee,{ref:"ps_warning_dialog"},null,512)],64)}var It=Fe(ze,[["render",_o]]);export{It as default};
