import{Z as Tt,i as I,O as vt,y as bt,j as Ut,k as Pt,z as S,o as l,c as g,b as c,w as d,a as m,m as pe,q as n,t as a,f as A,h as Ue,g as P,n as Pe,F as rt,s as wt,a0 as Et,r as w,E as Ot}from"./app.df1b8390.js";import{f as we}from"./index.esm.159b9749.js";import"./auth.esm.925cebae.js";import Bt from"./PsFrontendLayout.9c0ecc46.js";import Ht from"./PsInput.699f2c15.js";import Dt from"./PsLine.40e0def3.js";import Rt from"./PsContentContainer.2eb168de.js";import Mt from"./PsBreadcrumb2.43f3d05c.js";import Lt from"./PsButton.935d57c3.js";import Ft from"./PsDropdown.e8bb7988.js";import{P as b}from"./PsUtils.2215fd6f.js";import Nt from"./PsIcon.0697a0d8.js";import Yt from"./PsLabel.3935ab2c.js";import Gt from"./PsLabelTitle3.e120ce78.js";import qt from"./PsRouteLink.14f8a093.js";import Vt from"./PsLabelCaption2.c1547d30.js";import{P as h}from"./ps_constants.deaae373.js";import{u as zt}from"./NotificationStore.987a5d48.js";import{P as jt}from"./PsValueStore.08b5513c.js";import Jt from"./PsLoadingDialog.16642bee.js";import Xt from"./PsConfirmDialog2.4cc5e324.js";import Kt from"./PsErrorDialog.7e6a8a91.js";import Wt from"./PsSuccessDialog.c1cdc55a.js";import Zt from"./ChatImageDetail.267b14e8.js";import Qt from"./OfferModal.c3c076cb.js";import $t from"./BookingModal.811c578b.js";import es from"./ReviewModal.3843e850.js";import{u as ts}from"./GalleryStore.684551d9.js";import{b as ee}from"./PsApiService.317e88ef.js";import{u as ss}from"./UserStore.5c2fdd50.js";import{u as os}from"./GetChatHistoryStore.f897b4d5.js";import{u as rs}from"./AppInfoStore.4b2c5718.js";import{A as is}from"./AppInfoParameterHolder.e24d894d.js";import{u as as}from"./ChatHistoryListStore.55417f44.js";import{u as ls}from"./OfferStore.448b25eb.js";import{P as ns}from"./PsObject.a17ef38f.js";import{f as ds}from"./format.min.427d9f09.js";import{u as ms}from"./ProductStore.186e332b.js";import{U as cs,u as fs}from"./UserUnReadMessageParameterHolder.1742bc34.js";import{h as _s}from"./moment.9709ab41.js";import{_ as us}from"./plugin-vue_export-helper.21dcd24c.js";import"./FooterView.97dc7826.js";import"./FooterLinkSection.746092c6.js";import"./PsLink.0ee2fc53.js";import"./PsLabelCaption.a3843f8e.js";import"./ProductParameterHolder.b3159892.js";import"./DefaultPhoto.cc755f93.js";import"./PsNavTabBar.6c5f8913.js";import"./PsDropdownSelect.a0554af8.js";import"./PsIconToggle.27dcede3.js";import"./LocationModal.e33ab72c.js";import"./PsModal.11d3d0c2.js";import"./vue-neat-modal.fd4a8f96.js";import"./PsInputWithLeftIcon.bd6285ce.js";import"./LocationParameterHolder.5c9d98a1.js";import"./ItemLocationTownship.94979fe0.js";import"./PsSepetetedStore.9a31ac47.js";import"./ItemLocationTownshipStore.9af11738.js";import"./PsNavBar.9d521488.js";import"./PsConfirmDialog.d57ea5b9.js";import"./User.ca420d1f.js";import"./RatingDetail.291ad5d1.js";import"./UserListParameterHolder.d110b747.js";import"./ApiStatus.5720ba0b.js";import"./PsNotificationBox.cc3868e0.js";import"./Product.dc190b28.js";import"./Category.7c65464b.js";import"./DefaultIcon.e76b39a5.js";import"./SubCategory.1b4176e0.js";import"./UserDeleteItemParameterHolder.5d816aba.js";import"./NotiUnRegisterHolder.eefb692e.js";import"https://unpkg.com/delayed-scroll-restoration-polyfill@0.1.1/index.js";import"./PsLabelTitle.7685c780.js";import"./PsImageModal.18670872.js";import"./ItemCurrencyStore.802b3f4f.js";import"./PsLabelHeader6.bca25da2.js";import"./ItemEntryParameterHolder.bf01459c.js";import"./PsTimePicker.d65cc55e.js";import"./PsDatePicker.62491752.js";import"./vue3-datepicker.esm.00d4ea36.js";import"./index.edd1d404.js";import"./PsUtils.84756d19.js";import"./RatingSelected.61d509dc.js";import"./PsTextarea.45f4fd8c.js";import"./RatingHolder.575b113e.js";import"./ChatHistory.9258b4a4.js";import"./SyncChatHistoryParameterHolder.24ffbfbb.js";class hs{constructor(){this.itemId="",this.buyerUserId="",this.sellerUserId=""}GetChatHistoryParameterHolder(){this.itemId="",this.buyerUserId="",this.sellerUserId=""}toMap(){const r={};return r.item_id=this.itemId,r.buyer_user_id=this.buyerUserId,r.seller_user_id=this.sellerUserId,r}}class gs{constructor(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.negoPrice="",this.type="",this.isUserOnline="",this.message=""}MakeOfferParameterHolder(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.negoPrice="",this.type=h.CHAT_TO_SELLER,this.isUserOnline="",this.message=""}AcceptOfferParameterHolder(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.negoPrice="",this.type=h.CHAT_TO_BUYER,this.isUserOnline="",this.message=""}toMap(){const r={};return r.item_id=this.itemId,r.buyer_user_id=this.buyerUserId,r.seller_user_id=this.sellerUserId,r.nego_price=this.negoPrice,r.type=this.type,r.is_user_online=this.isUserOnline,r.message=this.message,r}}class ce{constructor(){this.addedDateTimeStamp=0,this.id="",this.isSold=!1,this.isUserBought=!1,this.itemId="",this.message="",this.offerStatus=0,this.sendByUserId="",this.sessionId="",this.type=0}ChatParameterHolder(){return this.addedDateTimeStamp=Math.floor(Date.now()),this.id="",this.isSold=!1,this.isUserBought=!1,this.itemId="",this.message="hi",this.offerStatus=h.CHAT_STATUS_NULL,this.sendByUserId="",this.sessionId="",this.type=h.CHAT_TYPE_TEXT,this}ChatAcceptParameterHolder(){return this.addedDateTimeStamp=Math.floor(Date.now()),this.id="",this.isSold=!1,this.isUserBought=!1,this.itemId="",this.message="",this.offerStatus=h.CHAT_STATUS_ACCEPT,this.sendByUserId="",this.sessionId="",this.type=h.CHAT_TYPE_ACCEPT,this}toMap(){const r={};return r.item_id=this.itemId,r.send_by_user_id=this.sendByUserId,r.message=this.message,r.type=this.type,r}}class ps{constructor(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.type=""}ResetUnReadMessageHolder(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.type=""}toMap(){const r={};return r.item_id=this.itemId,r.buyer_user_id=this.buyerUserId,r.seller_user_id=this.sellerUserId,r.type=this.type,r}}class Ee extends ns{constructor(){super(...arguments),this.id="",this.itemId="",this.sessionId="",this.key="",this.message="",this.type=0,this.sendByUserId="",this.offerStatus=0,this.addedDate="",this.isSold=!1,this.isUserBought=!1,this.dateTimeString="",this.dateString="",this.timeString=""}init(r,f,e,oe,R,re,T,C,_,E,k,Y,V,z){return this.id=r,this.itemId=f,this.sessionId=e,this.key=oe,this.message=R,this.type=re,this.sendByUserId=T,this.offerStatus=C,this.addedDate=_,this.isSold=E,this.isUserBought=k,this.dateTimeString=Y,this.dateString=V,this.timeString=z,this}getPrimaryKey(){return this.itemId}fromMap(r){return new Ee().init(r.id,r.itemId,r.sessionId,r.key,r.message,r.type,r.sendByUserId,r.offerStatus,r.addedDate,r.isSold,r.isUserBought,r.dateTimeString,r.dateString,r.timeString)}fromMapList(r){const f=[];for(const e in r)e!=null&&f.push(this.fromMap(e));return f}toMap(r){const f={};return f.id=r.id,f.itemId=r.itemId,f.sessionId=r.sessionId,f.key=r.key,f.message=r.message,f.type=r.type,f.sendByUserId=r.sendByUserId,f.offerStatus=r.offerStatus,f.addedDate=r.addedDate,f.isSold=r.isSold,f.isUserBought=r.isUserBought,f.dateTimeString=r.dateTimeString,f.dateString=r.dateString,f.timeString=r.timeString,f}toMapList(r){const f=[];for(let e=0;e<r.length;e++)r[e]!=null&&f.push(this.toMap(r[e]));return f}}class ys{constructor(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.isUserOnline=""}IsUserBoughtParameterHolder(){this.itemId="",this.buyerUserId="",this.sellerUserId="",this.isUserOnline=""}toMap(){const r={};return r.item_id=this.itemId,r.buyer_user_id=this.buyerUserId,r.seller_user_id=this.sellerUserId,r.is_user_online=this.isUserOnline,r}}const ks={name:"ChatView",components:{PsLabel:Yt,PsInput:Ht,PsLine:Dt,PsContentContainer:Rt,PsIcon:Nt,PsLabelTitle3:Gt,PsLabelCaption2:Vt,PsLoadingDialog:Jt,OfferModal:Qt,BookingModal:$t,PsConfirmDialog2:Xt,PsErrorDialog:Kt,PsSuccessDialog:Wt,ChatImageDetail:Zt,PsRouteLink:qt,ReviewModal:es,PsBreadcrumb2:Mt,PsButton:Lt,PsDropdown:Ft,Head:Tt},props:["query"],layout:Bt,setup(i){var Ge,qe,Ve,ze,je,Je,Xe,Ke,We,Ze,Qe,$e,et,tt;const f=jt().getLoginUserId(),e=I(!1);(f==null||f==""||f==h.NO_LOGIN_USER)&&vt.get(route("login"));const oe=new cs;oe.userId=f;const R=ms(),re=fs(),T=(Ve=(qe=(Ge=i.query)==null?void 0:Ge.buyer_user_id)==null?void 0:qe.toString())!=null?Ve:"",C=(Je=(je=(ze=i.query)==null?void 0:ze.seller_user_id)==null?void 0:je.toString())!=null?Je:"",_=I(""),E=I(""),k=(We=(Ke=(Xe=i.query)==null?void 0:Xe.item_id)==null?void 0:Ke.toString())!=null?We:"",Y=I("");let V=I("");const z=I(""),ie=($e=(Qe=(Ze=i.query)==null?void 0:Ze.chat_flag)==null?void 0:Qe.toString())!=null?$e:h.CHAT_FROM_BUYER,ae=I("0"),ye=new is;ye.userId=f;const H=rs(),fe=I(!1);((tt=(et=H==null?void 0:H.appInfo)==null?void 0:et.data)==null?void 0:tt.psAppSetting.SelectedChatType)==h.CHAT_AND_APPOINTMENT&&(fe.value=!0);async function ke(){}ke();const X=os(),xe=as(),K=ts();zt();const F=ls(),W=new hs,x=new gs,o=new ce().ChatParameterHolder(),D=new ys,G=new ps,v=I(),N=I(),s=I(),M=I(),O=I(),Oe=I(),Be=I(),He=I(),te=I(!1),De=I(),L=I(!1),q=b.sortinUserId(C,T),le=we.database().ref("Message/"+q),Re=we.database().ref("Current_Chat_With"),_e=we.database().ref("User_Presence");let j,ne=I("");C==f?j=T:j=C;const Me=ss("chat");Me.loadUser(j),G.itemId=k,G.buyerUserId=T,G.sellerUserId=C,ie==h.CHAT_FROM_SELLER?G.type=h.CHAT_TO_BUYER:G.type=h.CHAT_TO_SELLER;const Le=I(""),Se=bt({data:[]});async function Z(){var t,p;W.itemId=k,W.buyerUserId=T,W.sellerUserId=C,await X.loadChatHistory(W,f),te.value=!0,((p=(t=X.chatHistory)==null?void 0:t.data)==null?void 0:p.isOffer)=="1"&&(te.value=!1)}function Ae(t){t.target.scrollTop<50&&b.log("load more......")}function J(){const t=new Date().getTime();return b.getTimeStampDividedByOneThousand(parseInt(t.toString(),10))}async function it(t){o.id="",o.addedDateTimeStamp=J(),o.isSold=!1,o.isUserBought=!1,o.itemId=k,o.message=t,o.offerStatus=h.CHAT_STATUS_NULL,o.sendByUserId=f,o.sessionId=q,o.type=h.CHAT_TYPE_TEXT,await B(o,!0)}async function B(t,p=!1){var de;let y;t.id==""?y=(de=le.push().key)!=null?de:"":y=t.id;const u=t.sendByUserId,Q={addedDate:t.addedDateTimeStamp,id:y,isSold:t.isSold,isUserBought:t.isUserBought,itemId:t.itemId,message:t.message,offerStatus:t.offerStatus,sendByUserId:t.sendByUserId,sessionId:t.sessionId,type:t.type},$={itemId:t.itemId,receiverId:j,senderId:u},he={userId:u,userName:"Tester"};le.child(y).set(Q),Re.child(u).set($),_e.child(u).set(he);let se="0";L.value&&(se="1"),p&&(ie==h.CHAT_FROM_SELLER?X.postChatHistory(k,T,C,h.CHAT_TO_SELLER,se,t.message,f):X.postChatHistory(k,T,C,h.CHAT_TO_BUYER,se,t.message,f)),Le.value="",Fe(700)}let ue;function Fe(t){setTimeout(function(){ue!=null?ue.scrollTop=ue.scrollHeight+400:b.log("it null")},t)}function at(t){var p,y,u;return t.toString()=="0"?S("item_price__free"):ds((u=(y=(p=H==null?void 0:H.appInfo)==null?void 0:p.data)==null?void 0:y.mobileSetting)==null?void 0:u.price_format,t)}Ut(async()=>{var p,y,u,Q,$,he,se,de,st;const t={userId:f,userName:"Tester"};_e.child(f).set(t),await xe.resetUnreadMessageCount(f,G),re.postUserUnreadMessageCount(oe),await Z(),await R.loadItem(k,f),_.value=(p=R.item.data)==null?void 0:p.title,E.value=(u=(y=R.item.data)==null?void 0:y.category)==null?void 0:u.catName,Y.value=($=(Q=R.item.data)==null?void 0:Q.defaultPhoto)==null?void 0:$.imgPath,V.value=(he=R.item.data)==null?void 0:he.price,z.value=(de=(se=R.item.data)==null?void 0:se.itemCurrency)==null?void 0:de.currencySymbol,ae.value=(st=R.item.data)==null?void 0:st.isSoldOut,e.value=!0,window.addEventListener("scroll",Ae),ue=document.getElementById("messages"),le.orderByChild("itemId").equalTo(k).on("value",It=>{Se.data=[];const Ie=[];let Te="",ge=te.value;It.forEach(me=>{const U=me.val();if(U.key=me.key,U.offerStatus==h.CHAT_STATUS_REJECT||U.offerStatus==h.CHAT_STATUS_IS_USER_BOUGHT?ge=!0:U.offerStatus==h.CHAT_STATUS_SOLD?(ge=!1,ae.value="1"):ge=te.value,U!=null){if(U.dateTimeString=b.timeStampToDateString(U.addedDate),U.dateTimeString!=null&&U.dateTimeString!=""&&U.dateTimeString.includes(" ")){const ot=U.dateTimeString.split(" ");if(U.dateString=ot[0],U.timeString=ot[1],Te==""||Te!=U.dateString){Te=U.dateString;const be={};be.message=U.dateString,be.type=h.CHAT_TYPE_DATE,Ie.push(be)}}let ve=new Ee;ve=ve.fromMap(U),Ie.push(ve)}}),te.value=ge,Se.data=Ie.reverse(),Fe(1500),_e.child(j).on("value",me=>{me.val()!=null&&me.val().userId==j?L.value=!0:L.value=!1})})}),Pt(()=>{Re.child(f).remove(),_e.child(f).remove(),window.removeEventListener("scroll",Ae)});function lt(){De.value.click()}async function nt(t){const p=t.target.files;if(p&&p.length>1)b.log(p.length);else{let y;for(let u=0;u<p.length;u++)y=p[u];if(y!=null){v.value.openModal(),v.value.setMessage(S("chat__uploading_image"));let u;f==C?u=h.CHAT_TO_BUYER:u=h.CHAT_TO_SELLER;let Q="0";L.value&&(Q="1");const $=await K.postChatImageUpload(f,C,T,k,u,Q,y);$.status==ee.SUCCESS?(o.addedDateTimeStamp=J(),o.isSold=!1,o.isUserBought=!1,o.itemId=k,o.message=$.data.imgPath,o.offerStatus=h.CHAT_STATUS_NULL,o.sendByUserId=f,o.sessionId=q,o.type=h.CHAT_TYPE_IMAGE,await B(o,!0)):b.log("error"),v.value.closeModal()}}}function dt(){var t,p;((p=(t=H==null?void 0:H.appInfo)==null?void 0:t.data)==null?void 0:p.psAppSetting.SelectedChatType)==h.CHAT_AND_APPOINTMENT?Be.value.openModal(_.value,E.value,Y.value,z.value,V.value):Oe.value.openModal(_.value,E.value,Y.value,z.value,V.value)}async function mt(t){let p="0";L.value&&(p="1"),x.itemId=k,x.buyerUserId=T,x.sellerUserId=C,x.negoPrice=t,x.type=h.CHAT_TO_SELLER,x.isUserOnline=p,x.message=t,v.value.openModal();const y=await F.makeOffer(T,x);y.status==ee.ERROR?b.log(y.message):(o.id="",o.addedDateTimeStamp=J(),o.isSold=!1,o.isUserBought=!1,o.itemId=k,o.message=t,o.offerStatus=h.CHAT_STATUS_OFFER,o.sendByUserId=f,o.sessionId=q,o.type=h.CHAT_TYPE_OFFER,await B(o)),await Z(),v.value.closeModal()}async function ct(t,p){let y="0";L.value&&(y="1"),x.itemId=k,x.buyerUserId=T,x.sellerUserId=C,x.negoPrice=t,x.type=h.CHAT_TO_SELLER,x.isUserOnline=y,x.message=t,v.value.openModal();const u=await F.makeOffer(T,x);u.status==ee.ERROR?b.log(u.message):(o.id="",o.addedDateTimeStamp=J(),o.isSold=!1,o.isUserBought=!1,o.itemId=k,o.message=p+" "+t,o.offerStatus=h.CHAT_STATUS_OFFER,o.sendByUserId=f,o.sessionId=q,o.type=h.CHAT_TYPE_OFFER,await B(o)),await Z(),v.value.closeModal()}function ft(t){N.value.openModal(S("chat__confirm_title"),S("chat__confirm_to_accept_dialog"),S("chat__confirm"),S("chat__cancel"),()=>{_t(t)},()=>{b.log("cancel")})}async function _t(t){let p="0";L.value&&(p="1"),x.itemId=k,x.buyerUserId=T,x.sellerUserId=C,x.negoPrice=t.message,x.type=h.CHAT_TO_BUYER,x.isUserOnline=p,x.message=t.message,v.value.openModal();const y=await F.acceptOffer(f,x);if(y.status==ee.ERROR)b.log(y.message);else{o.id=t.id,o.isSold=!1,o.isUserBought=!1,o.itemId=t.itemId,o.message=t.message,o.offerStatus=h.CHAT_STATUS_OFFER,o.sendByUserId=t.sendByUserId,o.sessionId=t.sessionId,o.type=h.CHAT_TYPE_ACCEPT,o.addedDateTimeStamp=t.addedDate,await B(o);const u=new ce().ChatAcceptParameterHolder();u.addedDateTimeStamp=J(),u.isSold=!1,u.isUserBought=!1,u.itemId=k,u.message=t.message,u.offerStatus=h.CHAT_STATUS_ACCEPT,u.type=h.CHAT_TYPE_ACCEPT,u.sendByUserId=f,u.sessionId=q,await B(u)}await Z(),v.value.closeModal()}async function Ce(t){let p="0";L.value&&(p="1"),D.itemId=k,D.buyerUserId=T,D.sellerUserId=C,D.isUserOnline=p,v.value.openModal();const y=await F.isUserBought(f,D);if(y.status==ee.ERROR)b.log(y.message);else{o.addedDateTimeStamp=t.addedDate,o.isSold=!1,o.isUserBought=!0,o.id=t.id,o.itemId=t.itemId,o.message=t.message,o.offerStatus=h.CHAT_STATUS_ACCEPT,o.sendByUserId=t.sendByUserId,o.sessionId=t.sessionId,o.type=h.CHAT_TYPE_TEXT,await B(o);const u=new ce;u.addedDateTimeStamp=J(),u.isSold=!1,u.isUserBought=!0,u.itemId=k,u.message=t.message,u.offerStatus=h.CHAT_STATUS_IS_USER_BOUGHT,u.sendByUserId=f,u.sessionId=q,u.type=h.CHAT_TYPE_BOUGHT,await B(u)}await Z(),v.value.closeModal()}function ut(t){N.value.openModal(S("item_detail__mark_as_sold_out"),S("item_detail__confirm_to_sold_out"),S("chat__confirm"),S("chat__cancel"),()=>{ht(t)},()=>{b.log("Cancel")})}async function ht(t){D.itemId=k,D.buyerUserId=T,D.sellerUserId=C,v.value.openModal();const p=await F.markAsSold(f,D);if(p.status==ee.ERROR)b.log(p.message);else{o.id=t.id,o.isSold=!0,o.isUserBought=!0,o.itemId=t.itemId,o.message=t.message,o.offerStatus=h.CHAT_STATUS_ACCEPT,o.sendByUserId=t.sendByUserId,o.sessionId=t.sessionId,o.type=h.CHAT_TYPE_TEXT,o.addedDateTimeStamp=t.addedDate,await B(o);const y=new ce;y.addedDateTimeStamp=J(),y.isSold=!0,y.isUserBought=!0,y.itemId=k,y.message=t.message,y.offerStatus=h.CHAT_STATUS_SOLD,y.sendByUserId=f,y.sessionId=q,y.type=h.CHAT_TYPE_SOLD,await B(y)}await Z(),v.value.closeModal()}function gt(t){N.value.openModal(S("chat__reject_title"),S("chat__confirm_to_reject_dialog"),S("chat__confirm"),S("chat__cancel"),()=>{xt(t)},()=>{b.log("cancel")})}function pt(t){N.value.openModal(S("chat__user_pickup_title"),S("chat__confirm_to_user_pickup_dialog"),S("chat__confirm"),S("chat__cancel"),()=>{Ce(t)},()=>{b.log("cancel")})}function yt(t){N.value.openModal(S("chat_book_appoint_done"),S("chat__confirm_to_user_appointment_dialog"),S("chat__confirm"),S("chat__cancel"),()=>{Ce(t)},()=>{b.log("cancel")})}function kt(t,p=""){N.value.openModal(S("chat__delete_message_title"),S("chat__confirm_to_delete_dialog"),S("chat__remove"),S("chat__cancel"),()=>{p!=""?Ne(t.id):Ye(t.id,p)},()=>{b.log("cancel"),ne.value=""})}async function xt(t){let p="0";L.value&&(p="1"),x.itemId=k,x.buyerUserId=T,x.sellerUserId=C,x.negoPrice="0",x.type=h.CHAT_TO_BUYER,x.isUserOnline=p,x.message=t.message,v.value.openModal();const y=await F.makeOffer(f,x);if(y.status==ee.ERROR)b.log(y.message);else{o.id=t.id,o.isSold=!1,o.isUserBought=!1,o.itemId=t.itemId,o.message=t.message,o.offerStatus=h.CHAT_STATUS_OFFER,o.sendByUserId=t.sendByUserId,o.sessionId=t.sessionId,o.type=h.CHAT_TYPE_REJECT,o.addedDateTimeStamp=t.addedDate,await B(o);const u=new ce().ChatAcceptParameterHolder();u.addedDateTimeStamp=J(),u.isSold=!1,u.isUserBought=!1,u.itemId=k,u.message=t.message,u.offerStatus=h.CHAT_STATUS_REJECT,u.type=h.CHAT_TYPE_REJECT,u.sendByUserId=f,u.sessionId=q,await B(u)}await Z(),v.value.closeModal()}function St(t){O.value.openModal(t)}function At(){He.value.openModal(j,()=>{M.value.openModal(S("chat__review_error"))},()=>{s.value.openModal("",S("chat__review_sent"))})}async function Ne(t){await le.child(t).remove()}async function Ye(t,p){await le.child(t).remove(),K.postChatImageDelete(p,f)}function Ct(t){ne.value==""?ne.value=t!=null?t:"":ne.value=""}return{dataReady:e,chatHistoryProvider:X,userStore:Me,sellerUserId:C,handleScroll:Ae,chats:Se,chatFlag:ie,sendMessage:B,inputMessageController:Le,itemName:_,itemCategory:E,itemId:k,itemImageName:Y,itemPrice:V,currency:z,PsConst:h,loginUserId:f,otherUserId:j,isOtherUserOnline:L,onImageClick:lt,image:De,onImageSelected:nt,ps_loading_dialog:v,ps_confirm_dialog:N,makeOfferClicked:dt,offer_modal:Oe,booking_modal:Be,review_modal:He,submitOffer:ct,submitBooking:mt,offerProvider:F,acceptOffer:ft,rejectOffer:gt,sendNormalMessage:it,isUserBought:Ce,markAsSoldClick:ut,imageView:St,chat_image:O,showOffer:te,clickGiveReview:At,ps_error_dialog:M,ps_success_dialog:s,formatPrice:at,isSoldOut:ae,chatDelete:Ne,chatImageDelete:Ye,userPickup:pt,appointmentDone:yt,deleteChatId:ne,showDeleteDropDown:Ct,deleteConfirm:kt,moment:_s,appInfoStore:H,isBooking:fe}},computed:{breadcrumb(){return[{label:S("chat__chat_list"),url:route("fe_chat_list")},{label:"Chat",color:"text-fePrimary-500"}]}}},xs={class:"relative flex flex-col",style:{height:"90vh"}},Ss={class:"lg:mt-32 mt-28 h-48 flex flex-col"},As={class:"flex flex-wrap items-center mb-2 mt-2 p-2 bg-feAchromatic-50 rounded dark:bg-feAchromatic-900"},Cs={class:"flex flex-row content-end items-center cursor-pointer"},Is={alt:"Placeholder",width:"300px",height:"200px",class:"w-12 h-12 object-cover bg-feAchromatic-50 rounded-full me-2"},Ts={class:"grow"},vs={key:0,class:"flex flex-row items-center"},bs={key:1,class:"flex flex-row items-center"},Us=m("div",{class:"w-52"},null,-1),Ps={key:0},ws={key:0},Es={key:1},Os={key:0,class:"flex sm:flex-row justify-between bg-feAchromatic-50 p-2 rounded dark:bg-feAchromatic-900"},Bs={class:"flex flex-row cursor-pointer"},Hs={alt:"Placeholder",class:"w-16 h-16 bg-feAchromatic-50 rounded-md"},Ds={class:"grow grid grid-col-4 sm:flex sm:justify-between ms-4"},Rs={class:"col-span-2"},Ms={class:"col-span-2 sm:hidden flex items-center justify-end"},Ls={class:"col-span-4 flex items-center me-2"},Fs={key:0,class:"chat"},Ns={key:0},Ys={class:"flex w-full justify-center"},Gs={class:"px-4 py-2 mt-2 mb-1 rounded-lg inline-block font-medium"},qs={key:1},Vs={key:0},zs={key:0,class:"w-full flex justify-end ps-1/3 flex-row items-end"},js={class:"px-2 py-4 mt-2 mb-1 rounded-md inline-block rounded-bl-none bg-feInfo-500"},Js=m("br",null,null,-1),Xs=m("br",null,null,-1),Ks={key:1,class:"pe-1/3 flex flex-col"},Ws={class:"flex flex-row items-end"},Zs={class:"px-2 py-4 mt-2 mb-1 rounded-md inline-block rounded-br-none bg-feInfo-500"},Qs=m("br",null,null,-1),$s=m("br",null,null,-1),eo=m("br",{class:"sm:hidden"},null,-1),to={key:1},so={key:0,class:"w-full flex justify-end ps-1/3 flex-row items-end"},oo={class:"px-4 py-2 mt-2 mb-1 rounded-lg inline-block rounded-bl-none bg-feError-500 text-feAchromatic-50"},ro={key:1,class:"pe-1/3 flex flex-col"},io={class:"flex flex-row items-end"},ao={class:"px-4 py-2 mt-2 mb-1 rounded-lg inline-block rounded-br-none bg-feError-500"},lo={key:2},no={key:0},mo={key:1},co={key:0,class:"w-full flex flex-col justify-end items-end"},fo={class:"flex flex-row items-end mb-2"},_o={class:"px-2 py-4 rounded-md inline-block rounded-bl-none bg-feSuccess-500"},uo={key:0,class:"flex flex-row items-end mb-2"},ho={class:"px-2 py-4 rounded-md inline-block rounded-bl-none bg-feInfo-500"},go={key:1,class:"flex flex-row items-end mb-2"},po={class:"px-2 py-4 rounded-md inline-block rounded-bl-none bg-feError-500"},yo={key:2,class:"flex justify-center w-full mt-5"},ko={key:1,class:"pe-1/3 flex flex-col"},xo={class:"flex flex-row items-end mb-2"},So={class:"px-2 py-4 rounded-md inline-block rounded-br-none bg-feSuccess-500"},Ao={key:0,class:"flex flex-row items-end mb-2"},Co={class:"px-2 py-4 rounded-md inline-block rounded-br-none bg-feInfo-500"},Io={key:1,class:"flex flex-row items-end mb-2"},To={class:"px-2 py-4 rounded-md inline-block rounded-br-none bg-feError-500"},vo={key:3},bo={key:0,class:"w-full flex justify-end ps-1/3 flex-row items-end"},Uo={class:""},Po={class:"relative"},wo=["onClick"],Eo={class:"p-4 mt-2 mb-1 rounded-md inline-block rounded-bl-none bg-feSecondary-100 dark:bg-feAchromatic-800"},Oo={key:1,class:"pe-1/3 flex flex-row items-end"},Bo={class:"p-4 mt-2 mb-1 rounded-md inline-block rounded-br-none bg-fePrimary-500"},Ho={key:2},Do={class:"mt-5 mb-2 grid grid-cols-4 gap-x-4 sm:flex sm:flex-row sm:justify-center rtl:space-x-reverse sm:space-x-3"},Ro={class:"col-span-2"},Mo={key:0,class:"col-span-2"},Lo={key:3},Fo={class:"w-full mt-5 flex justify-center items-center"},No={key:4},Yo={key:0,class:"w-full flex justify-end ps-1/3 flex-row items-end"},Go={class:"px-2 py-4 mt-2 mb-1 rounded-md inline-block rounded-bl-none bg-feInfo-500"},qo=m("br",null,null,-1),Vo=m("br",null,null,-1),zo={key:1,class:"flex flex-col"},jo={class:"flex flex-row items-end"},Jo={class:"px-2 py-4 mt-2 mb-1 rounded-md block rounded-br-none bg-feInfo-500"},Xo=m("br",null,null,-1),Ko=m("br",null,null,-1),Wo={key:0,class:"mt-5 mb-2 grid grid-cols-4 gap-4 sm:flex sm:flex-row sm:justify-center rtl:space-x-reverse sm:space-x-4"},Zo={key:5},Qo={key:0,class:"w-full flex justify-end ps-1/3 flex-row items-end h-48 mt-4"},$o={class:"relative"},er=["onClick"],tr=["onClick"],sr={key:1,class:"pe-1/3 flex flex-row items-end h-48 mt-4"},or=["onClick"],rr={class:"mt-2 mb-0 sm:mb-0 absolute inset-y-full w-full"},ir={class:"relative flex pt-1 w-full"},ar={type:"button",class:"inline-flex items-center justify-center rounded-full h-10 w-10 transition duration-500 ease-in-out"},lr={class:"grow relative"};function nr(i,r,f,e,oe,R){const re=w("Head"),T=w("ps-breadcrumb-2"),C=w("ps-route-link"),_=w("ps-label"),E=w("ps-icon"),k=w("ps-button"),Y=w("ps-label-caption-2"),V=w("ps-input"),z=w("ps-content-container"),ie=w("ps-loading-dialog"),ae=w("ps-confirm-dialog-2"),ye=w("ps-error-dialog"),H=w("ps-success-dialog"),fe=w("chat-image-detail"),ke=w("offer-modal"),X=w("booking-modal"),xe=w("review-modal"),K=Ot("lazy");return l(),g(rt,null,[c(re,{title:i.$t("chat__title")},null,8,["title"]),c(z,{class:"h-screen"},{content:d(()=>{var F,W,x,o,D,G,v,N;return[m("div",xs,[m("div",Ss,[c(T,{items:R.breadcrumb},null,8,["items"]),m("div",As,[c(C,{to:{name:"fe_other_profile",query:{userId:(W=(F=e.userStore.user)==null?void 0:F.data)==null?void 0:W.userId}},class:"w-16"},{default:d(()=>{var s,M;return[m("div",Cs,[pe(m("img",Is,null,512),[[K,{src:i.$page.props.thumb1xUrl+"/"+((M=(s=e.userStore.user)==null?void 0:s.data)==null?void 0:M.userCoverPhoto),loading:i.$page.props.sysImageUrl+"/loading_gif.gif",error:i.$page.props.sysImageUrl+"/default_photo.png"}]])])]}),_:1},8,["to"]),m("div",Ts,[c(_,{class:"font-medium text-base"},{default:d(()=>{var s,M;return[n(a((M=(s=e.userStore.user)==null?void 0:s.data)==null?void 0:M.userName),1)]}),_:1}),e.isOtherUserOnline?(l(),g("div",vs,[c(E,{name:"dot",w:"10",h:"10",class:"text-feSuccess-300 me-2"}),c(_,null,{default:d(()=>[n(a(i.$t("chat__online")),1)]),_:1})])):(l(),g("div",bs,[c(E,{name:"dot",w:"10",h:"10",class:"text-feAchromatic-300 me-2"}),c(_,null,{default:d(()=>[n(a(i.$t("chat__offline")),1)]),_:1})]))]),Us,((o=(x=e.appInfoStore.appInfo.data)==null?void 0:x.psAppSetting)==null?void 0:o.SelectedPriceType)!=e.PsConst.PRICE_RANGE?(l(),g("div",Ps,[((G=(D=e.appInfoStore.appInfo.data)==null?void 0:D.psAppSetting)==null?void 0:G.SelectedChatType)==e.PsConst.CHAT_AND_OFFER?(l(),g("div",ws,[e.chatFlag==e.PsConst.CHAT_FROM_SELLER?(l(),A(k,{key:0,onClick:Ue(e.makeOfferClicked,["prevent"]),rounded:"rounded",class:"mt-2 sm:mt-0",disabled:!(e.isSoldOut!="1"&&e.showOffer)},{default:d(()=>[n(a(i.$t("chat__make_an_offer")),1)]),_:1},8,["onClick","disabled"])):P("",!0)])):P("",!0)])):P("",!0),((N=(v=e.appInfoStore.appInfo.data)==null?void 0:v.psAppSetting)==null?void 0:N.SelectedChatType)==e.PsConst.CHAT_AND_APPOINTMENT?(l(),g("div",Es,[e.chatFlag==e.PsConst.CHAT_FROM_SELLER?(l(),A(k,{key:0,onClick:Ue(e.makeOfferClicked,["prevent"]),rounded:"rounded",class:"mt-2 sm:mt-0",disabled:!(e.isSoldOut!="1"&&e.showOffer)},{default:d(()=>[n(a(i.$t("chat_book")),1)]),_:1},8,["onClick","disabled"])):P("",!0)])):P("",!0)]),e.dataReady?(l(),g("div",Os,[c(C,{to:{name:"fe_item_detail",query:{item_id:e.itemId}}},{default:d(()=>[m("div",Bs,[pe(m("img",Hs,null,512),[[K,{src:i.$page.props.thumb2xUrl+"/"+e.itemImageName,loading:i.$page.props.sysImageUrl+"/loading_gif.gif",error:i.$page.props.sysImageUrl+"/default_photo.png"}]])])]),_:1},8,["to"]),m("div",Ds,[m("div",Rs,[c(_,{textColor:"font-semibold text-fePrimary-500",class:"text-xs sm:text-xl"},{default:d(()=>[n(a(e.itemName),1)]),_:1}),c(_,{class:"font-normal text-lg"},{default:d(()=>[n(a(e.itemCategory),1)]),_:1}),c(_,{class:"font-normal text-xs",textColor:"text-feAchromatic-500"},{default:d(()=>[n(a(e.currency)+" "+a(e.formatPrice(e.itemPrice)),1)]),_:1})]),m("div",Ms,[c(C,{to:{name:"fe_item_detail",query:{item_id:e.itemId}},class:"block sm:hidden"},{default:d(()=>[c(E,{name:"doubleRightArrow"})]),_:1},8,["to"])]),m("div",Ls,[c(k,{class:Pe([e.isSoldOut=="1"?"":"hidden","h-[20px] sm:h-[28px]"]),rounded:"rounded",hover:!1},{default:d(()=>[n(a(i.$t("chat__mark_sold_out")),1)]),_:1},8,["class"]),c(C,{to:{name:"fe_item_detail",query:{item_id:e.itemId}},class:"hidden sm:block"},{default:d(()=>[c(E,{name:"doubleRightArrow"})]),_:1},8,["to"])])])])):P("",!0)]),m("div",{ref:"messages",onScroll:r[2]||(r[2]=(...s)=>e.handleScroll&&e.handleScroll(...s)),id:"messages",class:"px-4 flex flex-col-reverse overflow-y-auto mt-14 sm:mt-3 h-full scrolling-touch"},[(l(!0),g(rt,null,wt(e.chats.data,s=>{var M;return l(),g("div",{key:(M=s.id)!=null?M:""},[s.message!=""&&s.message!=null?(l(),g("div",Fs,[s.type==e.PsConst.CHAT_TYPE_DATE?(l(),g("div",Ns,[m("div",Ys,[m("span",Gs,[c(_,null,{default:d(()=>[n(a(s.message),1)]),_:2},1024)])])])):s.type==e.PsConst.CHAT_TYPE_TEXT?(l(),g("div",qs,[s.offerStatus==e.PsConst.CHAT_STATUS_OFFER?(l(),g("div",Vs,[s.sendByUserId==e.loginUserId?(l(),g("div",zs,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",js,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50Dark"},{default:d(()=>[n(a(i.$t("chat_book_make_booking"))+" ",1),Js,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024)):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50Dark"},{default:d(()=>[n(a(i.$t("chat__send_offer"))+" ",1),Xs,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024))])])):(l(),g("div",Ks,[m("div",Ws,[m("span",Zs,[e.isBooking?(l(),A(_,{key:0,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_received_booking"))+" ",1),Qs,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024)):(l(),A(_,{key:1,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__receive_offer"))+" ",1),$s,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024))]),eo,c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)])]))])):s.offerStatus==e.PsConst.CHAT_STATUS_REJECT?(l(),g("div",to,[s.sendByUserId==e.loginUserId?(l(),g("div",so,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",oo,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_reject")),1)]),_:1})):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_rejected_item")),1)]),_:1}))])])):(l(),g("div",ro,[m("div",io,[m("span",ao,[e.isBooking?(l(),A(_,{key:0,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_reject")),1)]),_:1})):(l(),A(_,{key:1,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_rejected_item")),1)]),_:1}))]),c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)])]))])):s.offerStatus==e.PsConst.CHAT_STATUS_ACCEPT?(l(),g("div",lo,[s.isSold&&s.isUserBought?(l(),g("div",no)):(l(),g("div",mo,[s.sendByUserId==e.loginUserId?(l(),g("div",co,[m("div",fo,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",_o,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_accept")),1)]),_:1})):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_accepted_item")),1)]),_:1}))])]),s.isUserBought?(l(),g("div",uo,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",ho,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_appoint_done")),1)]),_:1})):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_item_pickup")),1)]),_:1}))])])):P("",!0),e.isSoldOut=="1"?(l(),g("div",go,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",po,[c(_,{class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_item_soldout")),1)]),_:1})])])):P("",!0),s.offerStatus==e.PsConst.CHAT_STATUS_ACCEPT&&s.isUserBought==!1?(l(),g("div",yo,[e.isBooking?(l(),A(k,{key:0,onClick:O=>e.appointmentDone(s),colors:"bg-feAchromatic-50 text-fePrimary-500 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",focus:"focus:text-feAchromatic-50 focus:bg-fePrimary-500",border:"border border-feAchromatic-300 dark:border-feAchromatic-500"},{default:d(()=>[n(a(i.$t("chat_book_appoint_done")),1)]),_:2},1032,["onClick"])):(l(),A(k,{key:1,onClick:O=>e.userPickup(s),colors:"bg-feAchromatic-50 text-fePrimary-500 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",focus:"focus:text-feAchromatic-50 focus:bg-fePrimary-500",border:"border border-feAchromatic-300 dark:border-feAchromatic-500"},{default:d(()=>[n(a(i.$t("chat__user_has_a_pickup")),1)]),_:2},1032,["onClick"]))])):P("",!0)])):(l(),g("div",ko,[m("div",xo,[m("span",So,[e.isBooking?(l(),A(_,{key:0,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_accept")),1)]),_:1})):(l(),A(_,{key:1,textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_accepted_item")),1)]),_:1}))]),c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]),s.isUserBought?(l(),g("div",Ao,[m("span",Co,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_appoint_done")),1)]),_:1})):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_item_pickup")),1)]),_:1}))]),c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)])):P("",!0),e.isSoldOut=="1"?(l(),g("div",Io,[m("span",To,[c(_,{class:"text-center",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__offer_item_soldout")),1)]),_:1})]),c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)])):P("",!0)]))]))])):(l(),g("div",vo,[s.sendByUserId==e.loginUserId?(l(),g("div",bo,[m("div",Uo,[c(Y,{onClick:O=>e.showDeleteDropDown(s.id),class:Pe([e.deleteChatId==s.id?"":"del","cursor-pointer rounded float-right"]),textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[c(E,{name:"verticalThreeDot",class:"text-feAchromatic-50Dark"})]),_:2},1032,["onClick","class"]),m("div",Po,[e.deleteChatId==s.id?(l(),g("div",{key:0,onClick:O=>e.deleteConfirm(s),class:"bg-feAchromatic-50 shadow-sm absolute top-4 right-2 px-5 py-1 rounded border transform cursor-pointer text-sm dark:bg-feAchromatic-900 dark:text-feAchromatic-50"},a(i.$t("chat__delete_messages")),9,wo)):P("",!0)]),c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]),m("span",Eo,[c(_,{class:"text-sm"},{default:d(()=>[n(a(s.message),1)]),_:2},1024)])])):(l(),g("div",Oo,[m("span",Bo,[c(_,{textColor:"text-feAchromatic-50",class:"text-sm"},{default:d(()=>[n(a(s.message),1)]),_:2},1024)]),c(_,{class:"ms-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]))]))])):s.type==e.PsConst.CHAT_TYPE_BOUGHT?(l(),g("div",Ho,[m("div",Do,[m("div",Ro,[c(k,{onClick:r[0]||(r[0]=O=>e.clickGiveReview()),colors:"bg-feAchromatic-50 text-fePrimary-500 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",border:"border border-feAchromatic-300 dark:border-feAchromatic-500"},{default:d(()=>[n(a(i.$t("chat__leave_a_review")),1)]),_:1})]),s.sendByUserId==e.loginUserId&&s.offerStatus==e.PsConst.CHAT_STATUS_IS_USER_BOUGHT?(l(),g("div",Mo,[c(k,{onClick:O=>e.markAsSoldClick(s),class:"w-full",colors:"bg-fePrimary-500 text-feAchromatic-50 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",border:"border border-feAchromatic-300 dark:border-feAchromatic-500"},{default:d(()=>[n(a(i.$t("chat__mark_sold_out")),1)]),_:2},1032,["onClick"])])):P("",!0)])])):s.type==e.PsConst.CHAT_TYPE_SOLD?(l(),g("div",Lo,[m("div",Fo,[m("div",null,[c(k,{onClick:r[1]||(r[1]=O=>e.clickGiveReview()),class:"h-9",colors:"bg-feAchromatic-50 text-fePrimary-500 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",border:"border border-feAchromatic-300 dark:border-feAchromatic-500"},{default:d(()=>[n(a(i.$t("chat__leave_a_review")),1)]),_:1})])])])):s.type==e.PsConst.CHAT_TYPE_OFFER?(l(),g("div",No,[s.sendByUserId==e.loginUserId?(l(),g("div",Yo,[c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024),m("span",Go,[e.isBooking?(l(),A(_,{key:0,class:"text-center",textColor:"text-feAchromatic-50Dark"},{default:d(()=>[n(a(i.$t("chat_book_make_booking"))+" ",1),qo,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024)):(l(),A(_,{key:1,class:"text-center",textColor:"text-feAchromatic-50Dark"},{default:d(()=>[n(a(i.$t("chat__send_offer"))+" ",1),Vo,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024))])])):(l(),g("div",zo,[m("div",jo,[m("span",Jo,[e.isBooking?(l(),A(_,{key:0,class:"dark:text-feAchromatic-800",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat_book_received_booking"))+" ",1),Xo,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024)):(l(),A(_,{key:1,class:"dark:text-feAchromatic-800",textColor:"text-feAchromatic-50"},{default:d(()=>[n(a(i.$t("chat__receive_offer"))+" ",1),Ko,n(a(e.itemPrice=="0"?i.$t("item_price__free"):s.message),1)]),_:2},1024))]),c(_,{class:"ms-2 mb-2 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-50"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]),s.offerStatus==e.PsConst.CHAT_STATUS_OFFER?(l(),g("div",Wo,[c(k,{onClick:O=>e.acceptOffer(s),class:"col-span-2 sm:w-[140px] h-9",textSize:"font-normal text-xxs lg:text-sm",colors:"bg-feSuccess-600 cursor-pointer text-feAchromatic-50",rounded:"rounded",hover:"hover:bg-feSuccess-700",focus:"focus:bg-feSuccess-700"},{default:d(()=>[n(a(i.$t("chat__accept")),1)]),_:2},1032,["onClick"]),c(k,{onClick:O=>e.rejectOffer(s),class:"col-span-2 sm:w-[140px] h-9",textSize:"font-normal text-xxs lg:text-sm",colors:"text-fePrimary-500 dark:bg-feAchromatic-800 dark:text-feAchromatic-200 hover:text-feAchromatic-50",focus:"focus:text-feAchromatic-50 focus:bg-fePrimary-500",border:"border border-feAchromatic-300 dark:border-feAchromatic-500",rounded:"rounded"},{default:d(()=>[n(a(i.$t("chat__reject")),1)]),_:2},1032,["onClick"])])):P("",!0)]))])):s.type==e.PsConst.CHAT_TYPE_IMAGE?(l(),g("div",Zo,[s.sendByUserId==e.loginUserId?(l(),g("div",Qo,[m("div",$o,[c(Y,{onClick:O=>e.showDeleteDropDown(s.id),class:Pe([e.deleteChatId==s.id?"":"del","cursor-pointer rounded float-right"]),textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[c(E,{name:"verticalThreeDot",class:"text-feAchromatic-50Dark"})]),_:2},1032,["onClick","class"]),e.deleteChatId==s.id?(l(),g("div",{key:0,onClick:O=>e.deleteConfirm(s,s.message),class:"bg-feAchromatic-50 shadow-sm absolute top-4 right-2 p-1 rounded border cursor-pointer transform"},a(i.$t("chat__delete_messages")),9,er)):P("",!0),c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]),pe(m("img",{onClick:O=>e.imageView(s.message),width:"300px",height:"200px",alt:"Placeholder",class:"cursor-pointer w-auto h-48 p-2 object-cover rounded-md"},null,8,tr),[[K,{src:i.$page.props.thumb3xUrl+"/"+s.message,loading:i.$page.props.sysImageUrl+"/loading_gif.gif",error:i.$page.props.sysImageUrl+"/default_photo.png"}]])])):(l(),g("div",sr,[pe(m("img",{onClick:O=>e.imageView(s.message),width:"300px",height:"200px",alt:"Placeholder",class:"cursor-pointer w-auto h-48 p-2 object-cover rounded-md"},null,8,or),[[K,{src:i.$page.props.thumb3xUrl+"/"+s.message,loading:i.$page.props.sysImageUrl+"/loading_gif.gif",error:i.$page.props.sysImageUrl+"/default_photo.png"}]]),c(_,{class:"me-2 mb-1 text-xs font-normal",textColor:"text-feAchromatic-50Dark dark:text-feAchromatic-400"},{default:d(()=>[n(a(s.timeString),1)]),_:2},1024)]))])):P("",!0)])):P("",!0)])}),128))],544),m("div",rr,[m("div",ir,[m("div",{for:"upload-image1",onClick:r[4]||(r[4]=(...s)=>e.onImageClick&&e.onImageClick(...s))},[m("input",{class:"py-2",type:"file",size:"1",max:"1",accept:".jpg,.jpeg,.png",onChange:r[3]||(r[3]=s=>e.onImageSelected(s)),ref:"image",id:"upload-image1",style:{display:"none"},ordering:1},null,544),m("button",ar,[c(E,{name:"camera",textColor:"text-fePrimary-500 dark:text-fePrimary-500"})])]),m("div",lr,[c(V,{placeholder:i.$t("chat__type_message"),onKeyup:r[5]||(r[5]=Et(s=>e.sendNormalMessage(e.inputMessageController),["enter"])),value:e.inputMessageController,"onUpdate:value":r[6]||(r[6]=s=>e.inputMessageController=s),class:"mt-1",theme:"form-input dark:bg-feAchromatic-800 text-feSecondary-500 dark:text-feAchromatic-50"},null,8,["placeholder","value"]),m("button",{type:"button",onClick:r[7]||(r[7]=Ue(s=>e.sendNormalMessage(e.inputMessageController),["prevent"])),class:"absolute right-3 top-3"},[c(E,{name:"send",textColor:"text-fePrimary-500 dark:text-fePrimary-500"})])])])])])]}),_:1}),c(ie,{ref:"ps_loading_dialog"},null,512),c(ae,{ref:"ps_confirm_dialog"},null,512),c(ye,{ref:"ps_error_dialog"},null,512),c(H,{ref:"ps_success_dialog"},null,512),c(fe,{ref:"chat_image"},null,512),c(ke,{ref:"offer_modal",price:e.itemPrice,onSubmit:e.submitOffer},null,8,["price","onSubmit"]),c(X,{ref:"booking_modal",price:e.itemPrice,onSubmit:e.submitBooking},null,8,["price","onSubmit"]),c(xe,{ref:"review_modal"},null,512)],64)}var Gi=us(ks,[["render",nr]]);export{Gi as default};
